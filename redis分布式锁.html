<!DOCTYPE html>
<html><head>
			
		<title>Redis分布式锁</title>
		<base href="./">
		<meta id="root-path" root-path="./">

		<link rel="icon" sizes="96x96" href="https://publish-01.obsidian.md/access/f786db9fac45774fa4f0d8112e232d67/favicon-96x96.png">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=1.0, maximum-scale=5.0">
		<meta charset="UTF-8">
		<script src="https://code.iconify.design/iconify-icon/1.0.3/iconify-icon.min.js"></script>

			<link rel="stylesheet" href="lib/styles/obsidian-styles.css">
			<link rel="stylesheet" href="lib/styles/theme.css">
			<link rel="stylesheet" href="lib/styles/plugin-styles.css">
			<link rel="stylesheet" href="lib/styles/snippets.css">
			<style>  </style>

			
			<!-- Graph View Data -->
			<script>
			let nodes=
{"nodeCount":247,"linkCount":280,"radii":[7,7,7,6.947482638888889,6.80859375,6.582899305555555,6.4375,6.081597222222221,5.638888888888889,5.638888888888889,5.384982638888888,5.384982638888888,5.384982638888888,5.109375,5.109375,5.109375,5.109375,5.109375,5.109375,5.109375,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.812065972222222,4.493055555555555,4.493055555555555,4.493055555555555,4.493055555555555,4.493055555555555,4.493055555555555,4.493055555555555,4.493055555555555,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,4.15234375,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.7899305555555554,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3.4058159722222223,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"labels":["领域驱动设计","软件系统架构","计算机领域技术栈","从零开始搭建前端框架","Redis知识点","基于Spring Cloud Alibaba和领域驱动设计思想的微服务开发","Redis","微服务","聚合","Vue","Dashboard","MES","领域事件","带你彻底理解Java中的锁","Java","领域模型","聚合根","zadig","软件团队管理","Obsidian使用","redis-四种部署模式","kafka","golang","实体","值对象","DevOps","APS","Kubernetes","DevOps工具","Spring cloud分布式架构","敏捷开发 Scrum","Redis持久化","缓存","Sentinel","认知篇","统一身份管理系统功能设计","redis面试题","JVM性能调优","IO多路复用","Vue数据绑定","防腐层","pdf-资源列表_202206030257","spring cloud 开发准备说明","用户权限管理设计方案","分布式消息队列","一致性Hash","Redis分布式锁","NIO","JVM常用的垃圾回收器","axios","领域名词","限界上下文","容器化","Sentinel的优势","SCM","RDB","ERP","AOF","ElasticSearch","用户权限管理相关知识","统一身份管理系统-用户账号体系","悲观锁与乐观锁","微服务设计模式","幂等","分布式日志框架","分布式ID","关于缓存异常：缓存雪崩、击穿、穿透的解决方案","公平锁与非公平锁","使用消息队列的 10 个理由","springdoc-openapi","reids命令","Redis性能测试","Redis 总结精讲","JAVA四种引用类型","Dubbo","Docker安装教程","DDD领域驱动学习-美的","async-awai","3️⃣  Vue-Router","代码块学习卡片模版","缓存穿透","编排","缓存穿透-布尔过滤器","弹性边界","决策命令","Vue介绍","SPI","Redis哨兵模式","nacos","kubernates是什么","BridgX","动态多数据源","六边形架构","Docker","Obsidian proxy","Go Wails本地桌面应用","spring security","gitlab代码版本控制","ElasticSearch使用Docker安装","💻window工作开发软件","项目计划","Oauth2","golang","验证码组件","领域服务","雪花算法（SnowFlake)","雪花算法","自旋锁和阻塞锁","读写锁","服务发现机制","数据库实现分布式锁","敏捷开发-用户故事","将 Go 语言当成脚本来使用-gomacro","垃圾回收器-G1","分布式锁实现方法对比","使用TypeScript封装Axios工具类","从营销复制-业务中台代码开发规范&最佳实践-DDD","业务中台代码开发规范&最佳实践(复制)-DDD","Zookeeper分布式锁","vue集成vue-i18n","vue设置全局字体","Vue自定义组件","VUE小白问题","vscode","vite集成预处理scss","Vite如何多环境env配置","Vite","vanta.js","springdoc","TypeScript","spring boot 集成缓存落地","Redis集群模式","Redis在秒杀场景中的具体应用","Redis主从模式","Reactor反应堆-线程模型","Raft","plantUML","promise","Pinia","node.js","Netty为什么没有选择AIO","liteflow","Knife4j","kafka术语名词解释说明","JWT","JetBrain IDEA","Hash算法","GrayLog","Go语言GUI Demo之Walk","GORM","Go语法","golang环境安装","golang教程","golang环境变量介绍","Flowable","Double Dispatch","代码生成器.excalidraw","Docker-Mysql8安装","CQRS","CAS","CAP","AQS","awai","索引Index使用别名Aliases查询","渐进式","子域","可重入锁和不可重入锁","分布式服务架构：原理、设计与实战","事务脚本","Vue指令：v-model","Vue如何安装","Redis配置参数说明","Martin Fowler","Docker安装GitLab","CORS","Vue模版语法","统一身份认证开源项目","Kubernetes中文文档教程","Vue入门案例","k8s安装和卸载","EnterpriseArchitect","ElasticSearch问题汇总","Bing每日图片资源","COLA 架构","抖音","obsidian问题汇总","obsidian插件列表","obsidian-核心插件","obsidian callout语法","模板生成工具-v1.0.0","系统架构系列（四）：业务架构实战下篇 1","系统架构系列（五）：技术架构之高可扩展系统设计与实现","系统架构系列 (六)：技术架构要解决什么问题？","系统架构系列 (七)：如何从开源项目中汲取架构思维？","架构设计实践五部曲（二）：业务架构与产品架构设计实践","架构设计实践五部曲（三）：从领域模型提取数据架构","架构设计实践五部曲（一）：架构与架构图","实例分析：一整套业务系统产品技术架构的方法论","Spring Cloud Alibaba","一个高效建立团队工作协议的好方法","Scrum Master如何使用强有力的问题来引导团队","软件项目开发流程","软件建模","短视频","我的腾讯云主机","区块链","非阻塞IO多路复用机制","统一身份管理系统软件产品计划","用户权限-设计文档","未命名","未命名","未命名 2","未命名 1","未命名 1","应用架构","哈希表-hashtable","Windows10安装Linux容器【alpine】","Qt：跨平台图形界面开发工具","custom-admonitions.cadfbc.css","GUID-全局唯一标识符","Golang 实现邮箱服务","Drawing 2023-05-29 13.57.56.excalidraw","Drawing 2022-12-27 11.24.58.excalidraw","Drawing 2022-12-27 11.24.14.excalidraw","Drawing 2022-12-27 11.24.57.excalidraw","Drawing 2022-06-03 17.48.13.excalidraw","brew-MAC包管理器源更新","每日一图Banner模版","_about_","index-template","note-template","_about_","Redis-Docker安装","_about_","JAVA核心知识点整理-annotate","_about_","_about_","_about_","001-Project","系统架构系列（四）：业务架构实战下篇","手写一个Maven代码生成插件","需求规格说明书","想法","开源项目","_about_","Linux系统","Java核心知识整理_202206100710"],"paths":["001-project/notes/领域驱动设计.html","000-index/软件系统架构.html","000-index/计算机领域技术栈.html","001-project/前端项目开发/从零开始搭建前端框架.html","redis知识点.html","001-project/java/spring-cloud脚手架/基于spring-cloud-alibaba和领域驱动设计思想的微服务开发.html","001-project/notes/redis.html","003-resources/notes/微服务.html","008-字典卡片/dict/聚合.html","000-index/vue.html","dashboard.html","008-字典卡片/dict/mes.html","003-resources/notes/领域事件.html","带你彻底理解java中的锁.html","java.html","008-字典卡片/dict/领域模型.html","008-字典卡片/dict/聚合根.html","003-resources/notes/zadig.html","000-index/软件团队管理.html","000-index/obsidian使用.html","redis-四种部署模式.html","kafka.html","golang.html","008-字典卡片/dict/实体.html","008-字典卡片/dict/值对象.html","008-字典卡片/dict/devops.html","008-字典卡片/dict/aps.html","003-resources/notes/kubernetes.html","003-resources/notes/devops工具.html","002-areas/notes/spring-cloud分布式架构.html","002-areas/notes/敏捷开发-scrum.html","002-areas/notes/redis持久化.html","001-project/notes/缓存.html","001-project/notes/sentinel.html","000-index/认知篇.html","统一身份管理系统功能设计.html","redis面试题.html","jvm性能调优.html","io多路复用.html","003-resources/vue数据绑定.html","003-resources/notes/防腐层.html","002-areas/notes/pdf-资源列表_202206030257.html","001-project/java/spring-cloud脚手架/spring-cloud-开发准备说明.html","用户权限管理设计方案.html","分布式消息队列.html","一致性hash.html","redis分布式锁.html","nio.html","jvm常用的垃圾回收器.html","axios.html","008-字典卡片/dict/领域名词.html","008-字典卡片/dict/限界上下文.html","008-字典卡片/dict/容器化.html","008-字典卡片/dict/sentinel的优势.html","008-字典卡片/dict/scm.html","008-字典卡片/dict/rdb.html","008-字典卡片/dict/erp.html","008-字典卡片/dict/aof.html","000-index/elasticsearch.html","用户权限管理相关知识.html","统一身份管理系统-用户账号体系.html","悲观锁与乐观锁.html","微服务设计模式.html","幂等.html","分布式日志框架.html","分布式id.html","关于缓存异常：缓存雪崩、击穿、穿透的解决方案.html","公平锁与非公平锁.html","使用消息队列的-10-个理由.html","springdoc-openapi.html","reids命令.html","redis性能测试.html","redis-总结精讲.html","java四种引用类型.html","dubbo.html","docker安装教程.html","ddd领域驱动学习-美的.html","async-awai.html","3️⃣-vue-router.html","007-template/代码块学习卡片模版.html","008-字典卡片/dict/缓存穿透.html","008-字典卡片/dict/编排.html","008-字典卡片/dict/缓存穿透-布尔过滤器.html","008-字典卡片/dict/弹性边界.html","008-字典卡片/dict/决策命令.html","008-字典卡片/dict/vue介绍.html","008-字典卡片/dict/spi.html","008-字典卡片/dict/redis哨兵模式.html","008-字典卡片/dict/nacos.html","008-字典卡片/dict/kubernates是什么.html","008-字典卡片/dict/bridgx.html","003-resources/动态多数据源.html","003-resources/notes/六边形架构.html","003-resources/notes/docker.html","002-areas/notes/obsidian-proxy.html","001-project/前端项目开发/go-wails本地桌面应用.html","001-project/notes/spring-security.html","001-project/notes/gitlab代码版本控制.html","001-project/notes/elasticsearch使用docker安装.html","000-index/💻window工作开发软件.html","000-index/项目计划.html","000-index/oauth2.html","000-index/golang.html","验证码组件.html","领域服务.html","雪花算法（snowflake).html","雪花算法.html","自旋锁和阻塞锁.html","读写锁.html","服务发现机制.html","数据库实现分布式锁.html","敏捷开发-用户故事.html","将-go-语言当成脚本来使用-gomacro.html","垃圾回收器-g1.html","分布式锁实现方法对比.html","使用typescript封装axios工具类.html","从营销复制-业务中台代码开发规范&最佳实践-ddd.html","业务中台代码开发规范&最佳实践(复制)-ddd.html","zookeeper分布式锁.html","vue集成vue-i18n.html","vue设置全局字体.html","vue自定义组件.html","vue小白问题.html","vscode.html","vite集成预处理scss.html","vite如何多环境env配置.html","vite.html","vanta.js.html","springdoc.html","typescript.html","spring-boot-集成缓存落地.html","redis集群模式.html","redis在秒杀场景中的具体应用.html","redis主从模式.html","reactor反应堆-线程模型.html","raft.html","plantuml.html","promise.html","pinia.html","node.js.html","netty为什么没有选择aio.html","liteflow.html","knife4j.html","kafka术语名词解释说明.html","jwt.html","jetbrain-idea.html","hash算法.html","graylog.html","go语言gui-demo之walk.html","gorm.html","go语法.html","golang环境安装.html","golang教程.html","golang环境变量介绍.html","flowable.html","double-dispatch.html","excalidraw/代码生成器.excalidraw.html","docker-mysql8安装.html","cqrs.html","cas.html","cap.html","aqs.html","async/awai.html","008-字典卡片/dict/索引index使用别名aliases查询.html","008-字典卡片/dict/渐进式.html","008-字典卡片/dict/子域.html","008-字典卡片/dict/可重入锁和不可重入锁.html","008-字典卡片/dict/分布式服务架构：原理、设计与实战.html","008-字典卡片/dict/事务脚本.html","008-字典卡片/dict/vue指令：v-model.html","008-字典卡片/dict/vue如何安装.html","008-字典卡片/dict/redis配置参数说明.html","008-字典卡片/dict/martin-fowler.html","008-字典卡片/dict/docker安装gitlab.html","008-字典卡片/dict/cors.html","003-resources/vue模版语法.html","003-resources/notes/统一身份认证开源项目.html","003-resources/notes/kubernetes中文文档教程.html","003-resources/notes/vue入门案例.html","003-resources/notes/k8s安装和卸载.html","003-resources/notes/enterprisearchitect.html","003-resources/notes/elasticsearch问题汇总.html","003-resources/notes/bing每日图片资源.html","003-resources/notes/cola-架构.html","002-areas/notes/抖音.html","002-areas/notes/obsidian问题汇总.html","002-areas/notes/obsidian插件列表.html","002-areas/notes/obsidian-核心插件.html","002-areas/notes/obsidian-callout语法.html","001-project/前端项目开发/模板生成工具-v1.0.0.html","001-project/notes/系统架构系列（四）：业务架构实战下篇-1.html","001-project/notes/系统架构系列（五）：技术架构之高可扩展系统设计与实现.html","001-project/notes/系统架构系列-(六)：技术架构要解决什么问题？.html","001-project/notes/系统架构系列-(七)：如何从开源项目中汲取架构思维？.html","001-project/notes/架构设计实践五部曲（二）：业务架构与产品架构设计实践.html","001-project/notes/架构设计实践五部曲（三）：从领域模型提取数据架构.html","001-project/notes/架构设计实践五部曲（一）：架构与架构图.html","001-project/notes/实例分析：一整套业务系统产品技术架构的方法论.html","001-project/notes/spring-cloud-alibaba.html","001-project/notes/一个高效建立团队工作协议的好方法.html","001-project/notes/scrum-master如何使用强有力的问题来引导团队.html","000-index/软件项目开发流程.html","000-index/软件建模.html","000-index/短视频.html","000-index/我的腾讯云主机.html","000-index/区块链.html","非阻塞io多路复用机制.html","统一身份管理系统软件产品计划.html","用户权限-设计文档.html","未命名.html","未命名.html","未命名-2.html","未命名-1.html","未命名-1.html","应用架构.html","哈希表-hashtable.html","windows10安装linux容器【alpine】.html","qt：跨平台图形界面开发工具.html","obsidian/snippets/custom-admonitions.cadfbc.css.html","guid-全局唯一标识符.html","golang-实现邮箱服务.html","excalidraw/drawing-2023-05-29-13.57.56.excalidraw.html","excalidraw/drawing-2022-12-27-11.24.58.excalidraw.html","excalidraw/drawing-2022-12-27-11.24.14.excalidraw.html","excalidraw/drawing-2022-12-27-11.24.57.excalidraw.html","excalidraw/drawing-2022-06-03-17.48.13.excalidraw.html","brew-mac包管理器源更新.html","007-template/每日一图banner模版.html","007-template/_about_.html","007-template/index-template.html","007-template/note-template.html","008-字典卡片/_about_.html","008-字典卡片/dict/redis-docker安装.html","005-附件/_about_.html","005-附件/media/pdf/java核心知识点整理-annotate.html","003-resources/_about_.html","002-areas/_about_.html","001-project/_about_.html","001-project/001-project.html","001-project/notes/系统架构系列（四）：业务架构实战下篇.html","001-project/notes/手写一个maven代码生成插件.html","001-project/java/需求规格说明书.html","000-index/想法.html","000-index/开源项目.html","000-index/_about_.html","000-index/linux系统.html","000-index/java核心知识整理_202206100710.html"],"linkSources":[58,58,58,101,101,19,19,19,19,19,9,9,9,9,9,9,9,102,102,203,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,34,34,34,34,34,18,18,18,18,18,18,202,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,201,100,100,99,99,42,42,42,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,33,33,33,97,96,32,32,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,95,95,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,31,31,31,29,29,29,29,185,41,30,30,30,39,39,28,28,28,93,93,27,27,27,17,17,17,17,7,7,40,12,12,12,12,12,79,26,26,26,90,25,25,11,11,11,54,86,53,53,85,89,24,52,80,81,8,8,8,8,8,16,16,50,50,15,15,15,15,76,76,10,10,10,10,10,10,10,48,37,37,14,14,14,14,14,47,140,72,4,4,4,4,4,4,4,4,4,4,4,4,77,49,49,22,22,22,22,21,21,20,20,20,36,36,45,67,65,64,44,13,13,13,13,13,62,61,59,35,35],"linkTargets":[98,163,181,176,41,188,187,186,94,182,78,85,170,178,175,39,3,150,149,184,1,37,68,44,21,32,66,6,132,130,74,46,118,110,114,47,38,134,160,135,65,106,54,56,11,26,205,30,180,25,28,97,41,136,196,194,195,190,191,192,193,197,0,183,92,52,45,146,7,62,29,5,35,43,41,30,42,60,19,22,21,91,103,0,7,88,75,157,91,128,174,96,43,35,69,4,70,71,36,20,46,72,31,57,55,33,53,86,173,144,66,80,82,7,12,84,50,51,165,83,15,8,16,104,155,63,0,40,23,24,92,168,81,158,189,156,9,126,129,139,49,77,123,125,138,78,127,124,120,119,121,122,55,57,6,44,198,88,33,94,167,199,200,111,169,39,90,27,17,75,98,177,89,179,17,27,7,25,7,172,40,51,15,16,24,7,79,26,11,56,204,25,28,11,56,54,11,109,14,112,164,52,23,7,82,7,16,23,24,83,51,23,8,84,12,8,16,23,24,117,116,63,154,74,142,69,64,141,113,73,48,145,37,48,73,13,38,47,38,4,171,31,57,55,36,46,45,20,70,87,71,162,137,115,151,153,152,148,68,143,133,87,131,4,38,32,161,105,147,21,108,67,61,107,166,40,159,43,60,59]};
			let attractionForce = 1;
			let linkLength = 10;
			let repulsionForce = 150;
			let centralForce = 3;
			let edgePruning = 100;
			</script>
			
<script type="module" src="lib/scripts/graph_view.js"></script>

<script src="lib/scripts/graph_wasm.js"></script>

<script src="lib/scripts/tinycolor.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js" integrity="sha512-Ch/O6kL8BqUwAfCF7Ie5SX1Hin+BJgYH4pNjRqXdTEqMsis1TUYg+j6nnI9uduPjGaj7DN4UKCZgpvoExt6dkw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="lib/scripts/webpage.js"></script>

			</head><body class="mod-windows is-frameless is-hidden-frameless obsidian-app theme-light show-inline-title show-view-header minimal-theme minimal-default-dark minimal-default-light borders-title colorful-headings fancy-cursor colorful-active minimal-focus-mode links-int-on links-ext-on system-shade full-width-media img-grid labeled-nav trim-cols minimal-folding frosted-sidebar minimal-readable minimal-light minimal-dark table-default-width img-default-width iframe-wide contextual-typography hider-scroll hider-tooltips hider-meta is-focused" style="--zoom-factor:1; --font-interface-override:Consolas, Candara; --font-text-override:Consolas; --font-print-override:Consolas; --font-text-size:26px; --line-width:50em; --line-width-adaptive:50em; --file-line-width:50em; --content-width:500em; --sidebar-width:25em; --collapse-arrow-size:0.4em; --tree-horizontal-spacing:1em; --tree-vertical-spacing:0.5em; --sidebar-margin:12px;"><div class="webpage-container"><div class="sidebar-left sidebar"><div class="sidebar-content"><div><label class="theme-toggle-container" for="theme_toggle"><input class="theme-toggle-input" type="checkbox" id="theme_toggle"><div class="toggle-background"></div></label></div><div class="tree-container file-tree mod-nav-indicator" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">raindrop</span><button class="clickable-icon collapse-tree-button is-collapsed"><iconify-icon icon="ph:arrows-in-line-horizontal-bold" width="18px" height="18px" rotate="90deg" color="currentColor"></iconify-icon></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="000-index"><span class="tree-item-title">000-index</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/_about_.html"><span class="tree-item-title">_about_</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/💻window工作开发软件.html"><span class="tree-item-title">💻window工作开发软件</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/短视频.html"><span class="tree-item-title">短视频</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/计算机领域技术栈.html"><span class="tree-item-title">计算机领域技术栈</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/开源项目.html"><span class="tree-item-title">开源项目</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/区块链.html"><span class="tree-item-title">区块链</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/认知篇.html"><span class="tree-item-title">认知篇</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/软件建模.html"><span class="tree-item-title">软件建模</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/软件团队管理.html"><span class="tree-item-title">软件团队管理</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/软件系统架构.html"><span class="tree-item-title">软件系统架构</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/软件项目开发流程.html"><span class="tree-item-title">软件项目开发流程</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/我的腾讯云主机.html"><span class="tree-item-title">我的腾讯云主机</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/想法.html"><span class="tree-item-title">想法</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/项目计划.html"><span class="tree-item-title">项目计划</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/elasticsearch.html"><span class="tree-item-title">ElasticSearch</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/golang.html"><span class="tree-item-title">golang</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/java核心知识整理_202206100710.html"><span class="tree-item-title">Java核心知识整理_202206100710</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/linux系统.html"><span class="tree-item-title">Linux系统</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/oauth2.html"><span class="tree-item-title">Oauth2</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/obsidian使用.html"><span class="tree-item-title">Obsidian使用</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="000-index/vue.html"><span class="tree-item-title">Vue</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="001-project"><span class="tree-item-title">001-Project</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="001-project/前端项目开发"><span class="tree-item-title">前端项目开发</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/前端项目开发/从零开始搭建前端框架.html"><span class="tree-item-title">从零开始搭建前端框架</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/前端项目开发/模板生成工具-v1.0.0.html"><span class="tree-item-title">模板生成工具-v1.0.0</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/前端项目开发/go-wails本地桌面应用.html"><span class="tree-item-title">Go Wails本地桌面应用</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="001-project/java"><span class="tree-item-title">java</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="3"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="001-project/java/spring-cloud脚手架"><span class="tree-item-title">spring cloud脚手架</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/java/spring-cloud脚手架/基于spring-cloud-alibaba和领域驱动设计思想的微服务开发.html"><span class="tree-item-title">基于Spring Cloud Alibaba和领域驱动设计思想的微服务开发</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/java/spring-cloud脚手架/spring-cloud-开发准备说明.html"><span class="tree-item-title">spring cloud 开发准备说明</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/java/需求规格说明书.html"><span class="tree-item-title">需求规格说明书</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="001-project/notes"><span class="tree-item-title">notes</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/缓存.html"><span class="tree-item-title">缓存</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/架构设计实践五部曲（二）：业务架构与产品架构设计实践.html"><span class="tree-item-title">架构设计实践五部曲（二）：业务架构与产品架构设计实践</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/架构设计实践五部曲（三）：从领域模型提取数据架构.html"><span class="tree-item-title">架构设计实践五部曲（三）：从领域模型提取数据架构</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/架构设计实践五部曲（一）：架构与架构图.html"><span class="tree-item-title">架构设计实践五部曲（一）：架构与架构图</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/领域驱动设计.html"><span class="tree-item-title">领域驱动设计</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/实例分析：一整套业务系统产品技术架构的方法论.html"><span class="tree-item-title">实例分析：一整套业务系统产品技术架构的方法论</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/手写一个maven代码生成插件.html"><span class="tree-item-title">手写一个Maven代码生成插件</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/系统架构系列-(六)：技术架构要解决什么问题？.html"><span class="tree-item-title">系统架构系列 (六)：技术架构要解决什么问题？</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/系统架构系列-(七)：如何从开源项目中汲取架构思维？.html"><span class="tree-item-title">系统架构系列 (七)：如何从开源项目中汲取架构思维？</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/系统架构系列（四）：业务架构实战下篇.html"><span class="tree-item-title">系统架构系列（四）：业务架构实战下篇</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/系统架构系列（四）：业务架构实战下篇-1.html"><span class="tree-item-title">系统架构系列（四）：业务架构实战下篇 1</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/系统架构系列（五）：技术架构之高可扩展系统设计与实现.html"><span class="tree-item-title">系统架构系列（五）：技术架构之高可扩展系统设计与实现</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/一个高效建立团队工作协议的好方法.html"><span class="tree-item-title">一个高效建立团队工作协议的好方法</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/elasticsearch使用docker安装.html"><span class="tree-item-title">ElasticSearch使用Docker安装</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/gitlab代码版本控制.html"><span class="tree-item-title">gitlab代码版本控制</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/redis.html"><span class="tree-item-title">Redis</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/scrum-master如何使用强有力的问题来引导团队.html"><span class="tree-item-title">Scrum Master如何使用强有力的问题来引导团队</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/sentinel.html"><span class="tree-item-title">Sentinel</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/spring-cloud-alibaba.html"><span class="tree-item-title">Spring Cloud Alibaba</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/notes/spring-security.html"><span class="tree-item-title">spring security</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/_about_.html"><span class="tree-item-title">_about_</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="001-project/001-project.html"><span class="tree-item-title">001-Project</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="002-areas"><span class="tree-item-title">002-Areas</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="002-areas/notes"><span class="tree-item-title">notes</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/notes/抖音.html"><span class="tree-item-title">抖音</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/notes/敏捷开发-scrum.html"><span class="tree-item-title">敏捷开发 Scrum</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/notes/obsidian-callout语法.html"><span class="tree-item-title">obsidian callout语法</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/notes/obsidian-proxy.html"><span class="tree-item-title">Obsidian proxy</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/notes/obsidian-核心插件.html"><span class="tree-item-title">obsidian-核心插件</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/notes/obsidian插件列表.html"><span class="tree-item-title">obsidian插件列表</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/notes/obsidian问题汇总.html"><span class="tree-item-title">obsidian问题汇总</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/notes/pdf-资源列表_202206030257.html"><span class="tree-item-title">pdf-资源列表_202206030257</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/notes/redis持久化.html"><span class="tree-item-title">Redis持久化</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/notes/spring-cloud分布式架构.html"><span class="tree-item-title">Spring cloud分布式架构</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="002-areas/_about_.html"><span class="tree-item-title">_about_</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="003-resources"><span class="tree-item-title">003-Resources</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="003-resources/notes"><span class="tree-item-title">notes</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/防腐层.html"><span class="tree-item-title">防腐层</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/领域事件.html"><span class="tree-item-title">领域事件</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/六边形架构.html"><span class="tree-item-title">六边形架构</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/统一身份认证开源项目.html"><span class="tree-item-title">统一身份认证开源项目</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/微服务.html"><span class="tree-item-title">微服务</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/bing每日图片资源.html"><span class="tree-item-title">Bing每日图片资源</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/cola-架构.html"><span class="tree-item-title">COLA 架构</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/devops工具.html"><span class="tree-item-title">DevOps工具</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/docker.html"><span class="tree-item-title">Docker</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/elasticsearch问题汇总.html"><span class="tree-item-title">ElasticSearch问题汇总</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/enterprisearchitect.html"><span class="tree-item-title">EnterpriseArchitect</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/k8s安装和卸载.html"><span class="tree-item-title">k8s安装和卸载</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/kubernetes.html"><span class="tree-item-title">Kubernetes</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/kubernetes中文文档教程.html"><span class="tree-item-title">Kubernetes中文文档教程</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/vue入门案例.html"><span class="tree-item-title">Vue入门案例</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/notes/zadig.html"><span class="tree-item-title">zadig</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/_about_.html"><span class="tree-item-title">_about_</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/动态多数据源.html"><span class="tree-item-title">动态多数据源</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/vue模版语法.html"><span class="tree-item-title">Vue模版语法</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="003-resources/vue数据绑定.html"><span class="tree-item-title">Vue数据绑定</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="005-附件"><span class="tree-item-title">005-附件</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="005-附件/media"><span class="tree-item-title">media</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="3"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="005-附件/media/pdf"><span class="tree-item-title">pdf</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="4"><div class="tree-item-contents"><a class="tree-item-link" href="005-附件/media/pdf/java核心知识点整理-annotate.html"><span class="tree-item-title">JAVA核心知识点整理-annotate</span></a></div><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="005-附件/_about_.html"><span class="tree-item-title">_about_</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="007-template"><span class="tree-item-title">007-template</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="007-template/_about_.html"><span class="tree-item-title">_about_</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="007-template/代码块学习卡片模版.html"><span class="tree-item-title">代码块学习卡片模版</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="007-template/每日一图banner模版.html"><span class="tree-item-title">每日一图Banner模版</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="007-template/index-template.html"><span class="tree-item-title">index-template</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="007-template/note-template.html"><span class="tree-item-title">note-template</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="008-字典卡片"><span class="tree-item-title">008-字典卡片</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="008-字典卡片/dict"><span class="tree-item-title">dict</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/编排.html"><span class="tree-item-title">编排</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/弹性边界.html"><span class="tree-item-title">弹性边界</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/分布式服务架构：原理、设计与实战.html"><span class="tree-item-title">分布式服务架构：原理、设计与实战</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/缓存穿透.html"><span class="tree-item-title">缓存穿透</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/缓存穿透-布尔过滤器.html"><span class="tree-item-title">缓存穿透-布尔过滤器</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/渐进式.html"><span class="tree-item-title">渐进式</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/聚合.html"><span class="tree-item-title">聚合</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/聚合根.html"><span class="tree-item-title">聚合根</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/决策命令.html"><span class="tree-item-title">决策命令</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/可重入锁和不可重入锁.html"><span class="tree-item-title">可重入锁和不可重入锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/领域名词.html"><span class="tree-item-title">领域名词</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/领域模型.html"><span class="tree-item-title">领域模型</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/容器化.html"><span class="tree-item-title">容器化</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/实体.html"><span class="tree-item-title">实体</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/事务脚本.html"><span class="tree-item-title">事务脚本</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/索引index使用别名aliases查询.html"><span class="tree-item-title">索引Index使用别名Aliases查询</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/限界上下文.html"><span class="tree-item-title">限界上下文</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/值对象.html"><span class="tree-item-title">值对象</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/子域.html"><span class="tree-item-title">子域</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/aof.html"><span class="tree-item-title">AOF</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/aps.html"><span class="tree-item-title">APS</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/bridgx.html"><span class="tree-item-title">BridgX</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/cors.html"><span class="tree-item-title">CORS</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/devops.html"><span class="tree-item-title">DevOps</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/docker安装gitlab.html"><span class="tree-item-title">Docker安装GitLab</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/erp.html"><span class="tree-item-title">ERP</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/kubernates是什么.html"><span class="tree-item-title">kubernates是什么</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/martin-fowler.html"><span class="tree-item-title">Martin Fowler</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/mes.html"><span class="tree-item-title">MES</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/nacos.html"><span class="tree-item-title">nacos</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/rdb.html"><span class="tree-item-title">RDB</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/redis-docker安装.html"><span class="tree-item-title">Redis-Docker安装</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/redis配置参数说明.html"><span class="tree-item-title">Redis配置参数说明</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/redis哨兵模式.html"><span class="tree-item-title">Redis哨兵模式</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/scm.html"><span class="tree-item-title">SCM</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/sentinel的优势.html"><span class="tree-item-title">Sentinel的优势</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/spi.html"><span class="tree-item-title">SPI</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/vue介绍.html"><span class="tree-item-title">Vue介绍</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/vue如何安装.html"><span class="tree-item-title">Vue如何安装</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/dict/vue指令：v-model.html"><span class="tree-item-title">Vue指令：v-model</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="008-字典卡片/_about_.html"><span class="tree-item-title">_about_</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="async"><span class="tree-item-title">async</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="async/awai.html"><span class="tree-item-title">awai</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="excalidraw"><span class="tree-item-title">Excalidraw</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="excalidraw/代码生成器.excalidraw.html"><span class="tree-item-title">代码生成器.excalidraw</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="excalidraw/drawing-2022-06-03-17.48.13.excalidraw.html"><span class="tree-item-title">Drawing 2022-06-03 17.48.13.excalidraw</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="excalidraw/drawing-2022-12-27-11.24.14.excalidraw.html"><span class="tree-item-title">Drawing 2022-12-27 11.24.14.excalidraw</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="excalidraw/drawing-2022-12-27-11.24.57.excalidraw.html"><span class="tree-item-title">Drawing 2022-12-27 11.24.57.excalidraw</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="excalidraw/drawing-2022-12-27-11.24.58.excalidraw.html"><span class="tree-item-title">Drawing 2022-12-27 11.24.58.excalidraw</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="excalidraw/drawing-2023-05-29-13.57.56.excalidraw.html"><span class="tree-item-title">Drawing 2023-05-29 13.57.56.excalidraw</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="1"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="obsidian"><span class="tree-item-title">obsidian</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-folder mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="obsidian/snippets"><span class="tree-item-title">snippets</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-file" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="obsidian/snippets/custom-admonitions.cadfbc.css.html"><span class="tree-item-title">custom-admonitions.cadfbc.css</span></a></div><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="3️⃣-vue-router.html"><span class="tree-item-title">3️⃣  Vue-Router</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="悲观锁与乐观锁.html"><span class="tree-item-title">悲观锁与乐观锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="从营销复制-业务中台代码开发规范&amp;最佳实践-ddd.html"><span class="tree-item-title">从营销复制-业务中台代码开发规范&amp;最佳实践-DDD</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="带你彻底理解java中的锁.html"><span class="tree-item-title">带你彻底理解Java中的锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="读写锁.html"><span class="tree-item-title">读写锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="非阻塞io多路复用机制.html"><span class="tree-item-title">非阻塞IO多路复用机制</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="分布式日志框架.html"><span class="tree-item-title">分布式日志框架</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="分布式锁实现方法对比.html"><span class="tree-item-title">分布式锁实现方法对比</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="分布式消息队列.html"><span class="tree-item-title">分布式消息队列</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="分布式id.html"><span class="tree-item-title">分布式ID</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="服务发现机制.html"><span class="tree-item-title">服务发现机制</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="公平锁与非公平锁.html"><span class="tree-item-title">公平锁与非公平锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="关于缓存异常：缓存雪崩、击穿、穿透的解决方案.html"><span class="tree-item-title">关于缓存异常：缓存雪崩、击穿、穿透的解决方案</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="哈希表-hashtable.html"><span class="tree-item-title">哈希表-hashtable</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="将-go-语言当成脚本来使用-gomacro.html"><span class="tree-item-title">将 Go 语言当成脚本来使用-gomacro</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="垃圾回收器-g1.html"><span class="tree-item-title">垃圾回收器-G1</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="领域服务.html"><span class="tree-item-title">领域服务</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="幂等.html"><span class="tree-item-title">幂等</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="敏捷开发-用户故事.html"><span class="tree-item-title">敏捷开发-用户故事</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="使用消息队列的-10-个理由.html"><span class="tree-item-title">使用消息队列的 10 个理由</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="使用typescript封装axios工具类.html"><span class="tree-item-title">使用TypeScript封装Axios工具类</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="数据库实现分布式锁.html"><span class="tree-item-title">数据库实现分布式锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="统一身份管理系统-用户账号体系.html"><span class="tree-item-title">统一身份管理系统-用户账号体系</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="统一身份管理系统功能设计.html"><span class="tree-item-title">统一身份管理系统功能设计</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="统一身份管理系统软件产品计划.html"><span class="tree-item-title">统一身份管理系统软件产品计划</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="微服务设计模式.html"><span class="tree-item-title">微服务设计模式</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="未命名.html"><span class="tree-item-title">未命名</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="未命名-1.html"><span class="tree-item-title">未命名 1</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="雪花算法.html"><span class="tree-item-title">雪花算法</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="雪花算法（snowflake).html"><span class="tree-item-title">雪花算法（SnowFlake)</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="验证码组件.html"><span class="tree-item-title">验证码组件</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="业务中台代码开发规范&amp;最佳实践(复制)-ddd.html"><span class="tree-item-title">业务中台代码开发规范&amp;最佳实践(复制)-DDD</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="一致性hash.html"><span class="tree-item-title">一致性Hash</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="应用架构.html"><span class="tree-item-title">应用架构</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="用户权限-设计文档.html"><span class="tree-item-title">用户权限-设计文档</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="用户权限管理设计方案.html"><span class="tree-item-title">用户权限管理设计方案</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="用户权限管理相关知识.html"><span class="tree-item-title">用户权限管理相关知识</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="自旋锁和阻塞锁.html"><span class="tree-item-title">自旋锁和阻塞锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="aqs.html"><span class="tree-item-title">AQS</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="async-awai.html"><span class="tree-item-title">async-awai</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="axios.html"><span class="tree-item-title">axios</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="brew-mac包管理器源更新.html"><span class="tree-item-title">brew-MAC包管理器源更新</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="cap.html"><span class="tree-item-title">CAP</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="cas.html"><span class="tree-item-title">CAS</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="cqrs.html"><span class="tree-item-title">CQRS</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="dashboard.html"><span class="tree-item-title">Dashboard</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="ddd领域驱动学习-美的.html"><span class="tree-item-title">DDD领域驱动学习-美的</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="docker-mysql8安装.html"><span class="tree-item-title">Docker-Mysql8安装</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="docker安装教程.html"><span class="tree-item-title">Docker安装教程</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="double-dispatch.html"><span class="tree-item-title">Double Dispatch</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="dubbo.html"><span class="tree-item-title">Dubbo</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="flowable.html"><span class="tree-item-title">Flowable</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="go语法.html"><span class="tree-item-title">Go语法</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="go语言gui-demo之walk.html"><span class="tree-item-title">Go语言GUI Demo之Walk</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="golang.html"><span class="tree-item-title">golang</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="golang-实现邮箱服务.html"><span class="tree-item-title">Golang 实现邮箱服务</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="golang环境安装.html"><span class="tree-item-title">golang环境安装</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="golang环境变量介绍.html"><span class="tree-item-title">golang环境变量介绍</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="golang教程.html"><span class="tree-item-title">golang教程</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="gorm.html"><span class="tree-item-title">GORM</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="graylog.html"><span class="tree-item-title">GrayLog</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="guid-全局唯一标识符.html"><span class="tree-item-title">GUID-全局唯一标识符</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="hash算法.html"><span class="tree-item-title">Hash算法</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="io多路复用.html"><span class="tree-item-title">IO多路复用</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="java.html"><span class="tree-item-title">Java</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="java四种引用类型.html"><span class="tree-item-title">JAVA四种引用类型</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="jetbrain-idea.html"><span class="tree-item-title">JetBrain IDEA</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="jvm常用的垃圾回收器.html"><span class="tree-item-title">JVM常用的垃圾回收器</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="jvm性能调优.html"><span class="tree-item-title">JVM性能调优</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="jwt.html"><span class="tree-item-title">JWT</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="kafka.html"><span class="tree-item-title">kafka</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="kafka术语名词解释说明.html"><span class="tree-item-title">kafka术语名词解释说明</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="knife4j.html"><span class="tree-item-title">Knife4j</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="liteflow.html"><span class="tree-item-title">liteflow</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="netty为什么没有选择aio.html"><span class="tree-item-title">Netty为什么没有选择AIO</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="nio.html"><span class="tree-item-title">NIO</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="node.js.html"><span class="tree-item-title">node.js</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="pinia.html"><span class="tree-item-title">Pinia</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="plantuml.html"><span class="tree-item-title">plantUML</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="promise.html"><span class="tree-item-title">promise</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="qt：跨平台图形界面开发工具.html"><span class="tree-item-title">Qt：跨平台图形界面开发工具</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="raft.html"><span class="tree-item-title">Raft</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="reactor反应堆-线程模型.html"><span class="tree-item-title">Reactor反应堆-线程模型</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="redis-总结精讲.html"><span class="tree-item-title">Redis 总结精讲</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="redis-四种部署模式.html"><span class="tree-item-title">redis-四种部署模式</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="redis分布式锁.html"><span class="tree-item-title">Redis分布式锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="redis集群模式.html"><span class="tree-item-title">Redis集群模式</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="redis面试题.html"><span class="tree-item-title">redis面试题</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="redis性能测试.html"><span class="tree-item-title">Redis性能测试</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="redis在秒杀场景中的具体应用.html"><span class="tree-item-title">Redis在秒杀场景中的具体应用</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="redis知识点.html"><span class="tree-item-title">Redis知识点</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="redis主从模式.html"><span class="tree-item-title">Redis主从模式</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="reids命令.html"><span class="tree-item-title">reids命令</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="spring-boot-集成缓存落地.html"><span class="tree-item-title">spring boot 集成缓存落地</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="springdoc.html"><span class="tree-item-title">springdoc</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="springdoc-openapi.html"><span class="tree-item-title">springdoc-openapi</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="typescript.html"><span class="tree-item-title">TypeScript</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="vanta.js.html"><span class="tree-item-title">vanta.js</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="vite.html"><span class="tree-item-title">Vite</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="vite集成预处理scss.html"><span class="tree-item-title">vite集成预处理scss</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="vite如何多环境env配置.html"><span class="tree-item-title">Vite如何多环境env配置</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="vscode.html"><span class="tree-item-title">vscode</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="vue集成vue-i18n.html"><span class="tree-item-title">vue集成vue-i18n</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="vue设置全局字体.html"><span class="tree-item-title">vue设置全局字体</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="vue小白问题.html"><span class="tree-item-title">VUE小白问题</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="vue自定义组件.html"><span class="tree-item-title">Vue自定义组件</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="windows10安装linux容器【alpine】.html"><span class="tree-item-title">Windows10安装Linux容器【alpine】</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-file" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="zookeeper分布式锁.html"><span class="tree-item-title">Zookeeper分布式锁</span></a></div><div class="tree-item-children"></div></div></div></div></div></div><div class="document-container"><div class="markdown-preview-view markdown-rendered node-insert-event is-readable-line-width allow-fold-headings show-indentation-guide allow-fold-lists show-frontmatter" style="tab-size: 4;"><style id="MJX-CHTML-styles"></style><div class="markdown-preview-sizer markdown-preview-section" style="padding-bottom: ; padding-top: var(--file-margins); padding-right: var(--file-margins); padding-left: var(--file-margins); width: 100%; position: absolute;"><div class="markdown-preview-pusher" style="width: 1px; height: 0.1px; margin-bottom: 0px;"></div><div class="mod-header"></div><div data-heading="Redis分布式锁应用（实现+原理）" data-tag-name="h1" class="el-h1"><h1 data-heading="Redis分布式锁应用（实现+原理）" id="Redis分布式锁应用（实现+原理）">Redis分布式锁应用（实现+原理）</h1></div><div data-tag-name="p" class="el-p"><span>在分布式系统中，当不同进程或线程一起访问共享资源时，会造成资源争抢，如果不加以控制的话，就会引发程序错乱。此时使用分布式锁能够非常有效的解决这个问题，它采用了一种互斥机制来防止线程或进程间相互干扰，从而保证了数据的一致性。</span></div><div data-tag-name="p" class="el-p"><span>提示：如果对分布式系统这一概念不清楚，可参考百度百科《<a data-tooltip-position="top" aria-label="https://baike.baidu.com/item/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/4905336?fr=aladdin" rel="noopener" class="external-link" href="https://baike.baidu.com/item/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/4905336?fr=aladdin" target="_blank">分布式系统</a>》，简而言之，它是一种架构、一种模式。</span></div><div data-heading="Redis分布式锁介绍" data-tag-name="h2" class="el-h2"><h2 data-heading="Redis分布式锁介绍" id="Redis分布式锁介绍" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Redis分布式锁介绍</h2></div><div data-tag-name="p" class="el-p"><span>分布式锁并非是 Redis 独有，比如 MySQL 关系型数据库，以及 Zookeeper 分布式服务应用，它们都实现分布式锁，只不过 Redis 是基于缓存实现的。</span></div><div data-tag-name="p" class="el-p"><span>Redis 分布式锁有很对应用场景，举个简单的例子，比如春运时，您需要在 12306 上抢购回家火车票，但 Redis 数据库中只剩一张票了，此时有多个用户来预订购买，那么这张票会被谁抢走呢？Redis 服务器又是如何处理这种情景的呢？在这个过程中就需要使用分布式锁。</span></div><div data-tag-name="p" class="el-p"><span>Redis 分布式锁主要有以下特点：</span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>第一：互斥性是分布式锁的重要特点，在任意时刻，只有一个线程能够持有锁；</li>
<li data-line="1"><div class="list-bullet"></div>第二：锁的超时时间，一个线程在持锁期间挂掉了而没主动释放锁，此时通过超时时间来保证该线程在超时后可以释放锁，这样其他线程才可以继续获取锁；</li>
<li data-line="2"><div class="list-bullet"></div>第三：加锁和解锁必须是由同一个线程来设置；</li>
<li data-line="3"><div class="list-bullet"></div>第四：Redis 是缓存型数据库，拥有很高的性能，因此加锁和释放锁开销较小，并且能够很轻易地实现分布式锁。</li>
</ul></div><div data-tag-name="p" class="el-p"><span>注意：一个线程代表一个客户端。</span></div><div data-heading="Redis分布式锁命令" data-tag-name="h2" class="el-h2"><h2 data-heading="Redis分布式锁命令" id="Redis分布式锁命令" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Redis分布式锁命令</h2></div><div data-tag-name="p" class="el-p"><span>分布式锁的本质其实就是要在 Redis 里面占一个“坑”，当别的进程也要来占时，发现已经有人蹲了，就只好放弃或者稍做等待。这个“坑”同一时刻只允许被一个客户端占据，也就是本着“先来先占”的原则。</span></div><div data-heading="1) 常用命令" data-tag-name="h4" class="el-h4"><h4 data-heading="1) 常用命令" id="1)_常用命令" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>1) 常用命令</h4></div><div data-tag-name="p" class="el-p"><span>Redis 分布式锁常用命令如下所示：</span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>SETNX key val：仅当key不存在时，设置一个 key 为 value 的字符串，返回1；若 key 存在，设置失败，返回 0；</li>
<li data-line="1"><div class="list-bullet"></div>Expire key timeout：为 key 设置一个超时时间，以 second 秒为单位，超过这个时间锁会自动释放，避免死锁；</li>
<li data-line="2"><div class="list-bullet"></div>DEL key：删除 key。</li>
</ul></div><div data-tag-name="p" class="el-p"><span>上述 SETNX 命令相当于占“坑”操作，EXPIRE 是为避免出现意外用来设置锁的过期时间，也就是说到了指定的过期时间，该客户端必须让出锁，让其他客户端去持有。  </span></div><div data-tag-name="p" class="el-p"><span>但还有一种情况，如果在 SETNX 和 EXPIRE 之间服务器进程突然挂掉，也就是还未设置过期时间，这样就会导致 EXPIRE 执行不了，因此还是会造成“死锁”的问题。为了避免这个问题，Redis 作者在 2.6.12 版本后，对 SET 命令参数做了扩展，使它可以同时执行 SETNX 和 EXPIRE 命令，从而解决了死锁的问题。</span></div><div data-tag-name="p" class="el-p"><span>直接使用 SET 命令实现，语法格式如下：</span></div><div data-tag-name="p" class="el-p"><span>SET key value [expiration EX seconds|PX milliseconds] [NX|XX]  </span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>EX second：设置键的过期时间为 second 秒。 SET key value EX second 效果等同于 SETEX key second value 。</li>
<li data-line="1"><div class="list-bullet"></div>PX millisecond：设置键的过期时间为毫秒。SET key value PX millisecond 效果等同于 PSETEX key millisecondvalue 。</li>
<li data-line="2"><div class="list-bullet"></div>NX：只在键不存在时，才对键进行设置操作。 SET key value NX 效果等同于 SETNX key value 。</li>
<li data-line="3"><div class="list-bullet"></div>XX：只在键已经存在时，才对键进行设置操作。</li>
</ul></div><div data-tag-name="hr" class="el-hr"><hr></div><div data-heading="Redis 分布式锁的正确实现原理演化历程与 Redission 实战总结" data-tag-name="h1" class="el-h1"><h1 data-heading="Redis 分布式锁的正确实现原理演化历程与 Redission 实战总结" id="Redis_分布式锁的正确实现原理演化历程与_Redission_实战总结">Redis 分布式锁的正确实现原理演化历程与 Redission 实战总结</h1></div><div data-tag-name="p" class="el-p"><span>Redis 分布式锁使用&nbsp;<code>SET</code>&nbsp;指令就可以实现了么？在分布式领域&nbsp;<code>CAP</code>&nbsp;理论一直存在。</span></div><div data-tag-name="p" class="el-p"><span>分布式锁的门道可没那么简单，我们在网上看到的分布式锁方案可能是有问题的。</span></div><div data-tag-name="p" class="el-p"><span>「码哥」一步步带你深入分布式锁是如何一步步完善，在高并发生产环境中如何正确使用分布式锁。</span></div><div data-tag-name="p" class="el-p"><span>在进入正文之前，我们先带着问题去思考：</span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>什么时候需要分布式锁？</li>
<li data-line="1"><div class="list-bullet"></div>加、解锁的代码位置有讲究么？</li>
<li data-line="2"><div class="list-bullet"></div>如何避免出现锁再也无法删除？「」</li>
<li data-line="3"><div class="list-bullet"></div>超时时间设置多少合适呢？</li>
<li data-line="4"><div class="list-bullet"></div>如何避免锁被其他线程释放</li>
<li data-line="5"><div class="list-bullet"></div>如何实现重入锁？</li>
<li data-line="6"><div class="list-bullet"></div>主从架构会带来什么安全问题？</li>
<li data-line="7"><div class="list-bullet"></div>什么是&nbsp;<code>Redlock</code></li>
<li data-line="8"><div class="list-bullet"></div>Redisson 分布式锁最佳实战</li>
<li data-line="9"><div class="list-bullet"></div>看门狗实现原理</li>
<li data-line="10"><div class="list-bullet"></div>……</li>
</ul></div><div data-heading="什么时候用分布式锁？" data-tag-name="h2" class="el-h2"><h2 data-heading="什么时候用分布式锁？" id="什么时候用分布式锁？" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>什么时候用分布式锁？</h2></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>码哥，说个通俗的例子讲解下什么时候需要分布式锁呢？</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>诊所只有一个医生，很多患者前来就诊。</span></div><div data-tag-name="p" class="el-p"><span>医生在同一时刻只能给一个患者提供就诊服务。如果不是这样的话，就会出现医生在就诊肾亏的「肖菜鸡」准备开药时候患者切换成了脚臭的「谢霸哥」，这时候药就被谢霸哥取走了。</span></div><div data-tag-name="p" class="el-p"><span>治肾亏的药被有脚臭的拿去了。</span></div><div data-tag-name="p" class="el-p"><span>当并发去读写一个【共享资源】的时候，我们为了保证数据的正确，需要控制同一时刻只有一个线程访问。</span></div><div data-tag-name="p" class="el-p"><span><strong>分布式锁就是用来控制同一时刻，只有一个 JVM 进程中的一个线程可以访问被保护的资源。</strong></span></div><div data-heading="分布式锁入门" data-tag-name="h2" class="el-h2"><h2 data-heading="分布式锁入门" id="分布式锁入门" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>分布式锁入门</h2></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>65 哥：分布式锁应该满足哪些特性？</span>
</blockquote></div><div data-tag-name="ol" class="el-ol"><ol>
<li data-line="0">互斥：在任何给定时刻，只有一个客户端可以持有锁；</li>
<li data-line="1">无死锁：任何时刻都有可能获得锁，即使获取锁的客户端崩溃；</li>
<li data-line="2">容错：只要大多数&nbsp;<code>Redis</code>的节点都已经启动，客户端就可以获取和释放锁。</li>
</ol></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>码哥，我可以使用&nbsp;<code>SETNX key value</code>&nbsp;命令是实现「互斥」特性。</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>这个命令来自于<code>SET if Not eXists</code>的缩写，意思是：如果&nbsp;<code>key</code>&nbsp;不存在，则设置&nbsp;<code>value</code>&nbsp;给这个<code>key</code>，否则啥都不做。Redis 官方地址说的：</span></div><div data-tag-name="p" class="el-p"><span>命令的返回值：</span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>1：设置成功；</li>
<li data-line="1"><div class="list-bullet"></div>0：key 没有设置成功。</li>
</ul></div><div data-tag-name="p" class="el-p"><span>如下场景：</span></div><div data-tag-name="p" class="el-p"><span>敲代码一天累了，想去放松按摩下肩颈。</span></div><div data-tag-name="p" class="el-p"><span>168 号技师最抢手，大家喜欢点，所以并发量大，需要分布式锁控制。</span></div><div data-tag-name="p" class="el-p"><span>同一时刻只允许一个「客户」预约 168 技师。</span></div><div data-tag-name="p" class="el-p"><span>肖菜鸡申请 168 技师成功：</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">&gt; SETNX lock:168 1
(integer) 1 # 获取 168 技师成功
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>谢霸哥后面到，申请失败：</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">&gt; SETNX lock 2
(integer) 0 # 客户谢霸哥 2 获取失败
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>此刻，申请成功的客户就可以享受 168 技师的肩颈放松服务「共享资源」。</span></div><div data-tag-name="p" class="el-p"><span>享受结束后，要及时释放锁，给后来者享受 168 技师的服务机会。</span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>肖菜鸡，码哥考考你如何释放锁呢？</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>很简单，使用&nbsp;<code>DEL</code>&nbsp;删除这个&nbsp;<code>key</code>&nbsp;就行。</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">&gt; DEL lock:168
(integer) 1
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>码哥，你见过「龙」么？我见过，因为我被一条龙服务过。</span>
</blockquote></div><div data-is-embed="true" data-embed-type="image" class="el-embed-image el-p" data-tag-name="p"><span><img src="https://pic1.zhimg.com/80/v2-3614fdf354cec7f85a8e25e9aeb8c640_720w.webp" referrerpolicy="no-referrer"></span></div><div data-tag-name="p" class="el-p"><span>肖菜鸡，事情可没这么简单。</span></div><div data-tag-name="p" class="el-p"><span>这个方案存在一个存在造成锁无法释放的问题，造成该问题的场景如下：</span></div><div data-tag-name="ol" class="el-ol"><ol>
<li data-line="0">客户端所在节点崩溃，无法正确释放锁；</li>
<li data-line="1">业务逻辑异常，无法执行&nbsp;<code>DEL</code>指令。</li>
</ol></div><div data-tag-name="p" class="el-p"><span>这样，这个锁就会一直占用，锁在我手里，我挂了，这样其他客户端再也拿不到这个锁了。</span></div><div data-heading="超时设置" data-tag-name="h2" class="el-h2"><h2 data-heading="超时设置" id="超时设置" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>超时设置</h2></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>码哥，我可以在获取锁成功的时候设置一个「超时时间」</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>比如设定按摩服务一次 60 分钟，那么在给这个&nbsp;<code>key</code>&nbsp;加锁的时候设置 60 分钟过期即可：</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">&gt; SETNX lock:168 1  // 获取锁
(integer) 1
&gt; EXPIRE lock:168 60  // 60s 自动删除
(integer) 1
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>这样，到点后锁自动释放，其他客户就可以继续享受 168 技师按摩服务了。</span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>谁要这么写，就糟透了。</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>「加锁」、「设置超时」是两个命令，他们不是原子操作。</span></div><div data-tag-name="p" class="el-p"><span><strong>如果出现只执行了第一条，第二条没机会执行就会出现「超时时间」设置失败，依然出现锁无法释放。</strong></span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>码哥，那咋办，我想被一条龙服务，要解决这个问题</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>Redis 2.6.X 之后，官方拓展了&nbsp;<code>SET</code>&nbsp;命令的参数，满足了当 key 不存在则设置 value，同时设置超时时间的语义，并且满足原子性。</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">SET resource_name random_value NX PX 30000
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>NX：表示只有&nbsp;<code>resource_name</code>&nbsp;不存在的时候才能&nbsp;<code>SET</code>&nbsp;成功，从而保证只有一个客户端可以获得锁；</li>
<li data-line="1"><div class="list-bullet"></div>PX 30000：表示这个锁有一个 30 秒自动过期时间。</li>
</ul></div><div data-tag-name="p" class="el-p"><span>这样写还不够，我们还要防止不能释放不是自己加的锁。我们可以在 value 上做文章。</span></div><div data-tag-name="p" class="el-p"><span>继续往下看……</span></div><div data-heading="释放了不是自己加的锁" data-tag-name="h2" class="el-h2"><h2 data-heading="释放了不是自己加的锁" id="释放了不是自己加的锁" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>释放了不是自己加的锁</h2></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>这样我能稳妥的享受一条龙服务了么？</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>No，还有一种场景会导致<strong>释放别人的锁</strong>：</span></div><div data-tag-name="ol" class="el-ol"><ol>
<li data-line="0">客户 1 获取锁成功并设置设置 30 秒超时；</li>
<li data-line="1">客户 1 因为一些原因导致执行很慢（网络问题、发生 FullGC……），过了 30 秒依然没执行完，但是锁过期「自动释放了」；</li>
<li data-line="2">客户 2 申请加锁成功；</li>
<li data-line="3">客户 1 执行完成，执行&nbsp;<code>DEL</code>&nbsp;释放锁指令，这个时候就把客户 2 的锁给释放了。</li>
</ol></div><div data-tag-name="p" class="el-p"><span>有个关键问题需要解决：自己的锁只能自己来释放。</span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>我要如何删除是自己加的锁呢？</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>在执行&nbsp;<code>DEL</code>&nbsp;指令的时候，我们要想办法检查下这个锁是不是自己加的锁再执行删除指令。</span></div><div data-tag-name="p" class="el-p"><span><strong>解铃还须系铃人</strong></span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>码哥，我在加锁的时候设置一个「唯一标识」作为&nbsp;<code>value</code>&nbsp;代表加锁的客户端。<code>SET resource_name random_value NX PX 30000</code><br>
在释放锁的时候，客户端将自己的「唯一标识」与锁上的「标识」比较是否相等，匹配上则删除，否则没有权利释放锁。</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>伪代码如下：</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">// 比对 value 与 唯一标识
if (redis.get("lock:168").equals(random_value)){
   redis.del("lock:168"); //比对成功则删除
 }
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>有没有想过，这是&nbsp;<code>GET + DEL</code>&nbsp;指令组合而成的，这里又会涉及到原子性问题。</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>我们可以通过&nbsp;<code>Lua</code>&nbsp;脚本来实现，这样判断和删除的过程就是原子操作了。</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">// 获取锁的 value 与 ARGV[1] 是否匹配，匹配则执行 del
if redis.call("get",KEYS[1]) == ARGV[1] then
    return redis.call("del",KEYS[1])
else
    return 0
end
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>这样通过唯一值设置成 value 标识加锁的客户端很重要，仅使用 DEL 是不安全的，因为一个客户端可能会删除另一个客户端的锁。</span></div><div data-tag-name="p" class="el-p"><span>使用上面的脚本，每个锁都用一个随机字符串“签名”，只有当删除锁的客户端的“签名”与锁的 value 匹配的时候，才会删除它。</span></div><div data-tag-name="p" class="el-p"><span>官方文档也是这么说的：<a data-tooltip-position="top" aria-label="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3D6zO%252Bc%252BvlFreVnl1KFdyryg%253D%253D.jsCcbsqUtMd9NdOb%252FX7dMpK7GJjMRcZxkwbpYZSN7OZn%252BBpJU4p4gigODjoWV86P" rel="noopener" class="external-link" href="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3D6zO%252Bc%252BvlFreVnl1KFdyryg%253D%253D.jsCcbsqUtMd9NdOb%252FX7dMpK7GJjMRcZxkwbpYZSN7OZn%252BBpJU4p4gigODjoWV86P" target="_blank">https://redis.io/topics/distlock</a></span></div><div data-tag-name="p" class="el-p"><span>这个方案已经相对完美，我们用的最多的可能就是这个方案了。</span></div><div data-heading="正确设置锁超时" data-tag-name="h2" class="el-h2"><h2 data-heading="正确设置锁超时" id="正确设置锁超时" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>正确设置锁超时</h2></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>锁的超时时间怎么计算合适呢？</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>这个时间不能瞎写，一般要根据在测试环境多次测试，然后压测多轮之后，比如计算出平均执行时间 200 ms。</span></div><div data-tag-name="p" class="el-p"><span>那么锁的<strong>超时时间就放大为平均执行时间的 3~5 倍。</strong></span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>为啥要放放大呢？</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>因为如果锁的操作逻辑中有网络 IO操作、JVM FullGC 等，线上的网络不会总一帆风顺，我们要给网络抖动留有缓冲时间。</span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>那我设置更大一点，比如设置 1 小时不是更安全？</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>不要钻牛角，多大算大？</span></div><div data-tag-name="p" class="el-p"><span>设置时间过长，一旦发生宕机重启，就意味着 1 小时内，分布式锁的服务全部节点不可用。</span></div><div data-tag-name="p" class="el-p"><span>你要让运维手动删除这个锁么？</span></div><div data-tag-name="p" class="el-p"><span>只要运维真的不会打你。</span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>有没有完美的方案呢？不管时间怎么设置都不大合适。</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>我们可以让获得锁的线程开启一个<strong>守护线程</strong>，用来给快要过期的锁「续航」。</span></div><div data-tag-name="p" class="el-p"><span>加锁的时候设置一个过期时间，同时客户端开启一个「守护线程」，定时去检测这个锁的失效时间。</span></div><div data-tag-name="p" class="el-p"><span><strong>如果快要过期，但是业务逻辑还没执行完成，自动对这个锁进行续期，重新设置过期时间。</strong></span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>这个道理行得通，可我写不出。</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>别慌，已经有一个库把这些工作都封装好了他叫&nbsp;<strong>Redisson</strong>。</span></div><div data-tag-name="p" class="el-p"><span>在使用分布式锁时，它就采用了「自动续期」的方案来避免锁过期，这个守护线程我们一般也把它叫做「看门狗」线程。</span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>一路优化下来，方案似乎比较「严谨」了，抽象出对应的模型如下。</span>
</blockquote></div><div data-tag-name="ol" class="el-ol"><ol>
<li data-line="0">通过&nbsp;<code>SET lock_resource_name random_value NX PX expire_time</code>，同时启动守护线程为快要过期但还没执行完的客户端的锁续命;</li>
<li data-line="1">客户端执行业务逻辑操作共享资源；</li>
<li data-line="2">通过&nbsp;<code>Lua</code>&nbsp;脚本释放锁，先 get 判断锁是否是自己加的，再执行&nbsp;<code>DEL</code>。</li>
</ol></div><div data-is-embed="true" data-embed-type="image" class="el-embed-image el-p" data-tag-name="p"><span><img src="https://pic2.zhimg.com/80/v2-2697907e3e5d7adc760a98ca3dea4c31_720w.webp" referrerpolicy="no-referrer"></span></div><div data-tag-name="p" class="el-p"><span>这个方案实际上已经比较完美，能写到这一步已经打败 90% 的程序猿了。</span></div><div data-tag-name="p" class="el-p"><span>但是对于追求极致的程序员来说还远远不够：</span></div><div data-tag-name="ol" class="el-ol"><ol>
<li data-line="0">可重入锁如何实现？</li>
<li data-line="1">主从架构崩溃恢复导致锁丢失如何解决？</li>
<li data-line="2">客户端加锁的位置有门道么？</li>
</ol></div><div data-heading="加解锁代码位置有讲究" data-tag-name="h2" class="el-h2"><h2 data-heading="加解锁代码位置有讲究" id="加解锁代码位置有讲究" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>加解锁代码位置有讲究</h2></div><div data-tag-name="p" class="el-p"><span>根据前面的分析，我们已经有了一个「相对严谨」的分布式锁了。</span></div><div data-tag-name="p" class="el-p"><span>于是「谢霸哥」就写了如下代码将分布式锁运用到项目中，以下是伪代码逻辑：</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">public void doSomething() {
  redisLock.lock(); // 上锁
    try {
        // 处理业务
        .....
        redisLock.unlock(); // 释放锁
    } catch (Exception e) {
        e.printStackTrace();
    }
}
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>有没有想过：一旦执行业务逻辑过程中抛出异常，程序就无法执行释放锁的流程。</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span><strong>所以释放锁的代码一定要放在</strong>&nbsp;<strong><code>finally{}</code></strong>&nbsp;<strong>块中。</strong></span></div><div data-tag-name="p" class="el-p"><span>加锁的位置也有问题，放在 try 外面的话，如果执行&nbsp;<code>redisLock.lock()</code>&nbsp;加锁异常，但是实际指令已经发送到服务端并执行，只是客户端读取响应超时，就会导致没有机会执行解锁的代码。</span></div><div data-tag-name="p" class="el-p"><span>所以&nbsp;<code>redisLock.lock()</code>&nbsp;<strong>应该写在 try 代码块，这样保证一定会执行解锁逻辑。</strong></span></div><div data-tag-name="p" class="el-p"><span>综上所述，正确代码位置如下 ：</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">public void doSomething() {
    try {
        // 上锁
        redisLock.lock();
        // 处理业务
        ...
    } catch (Exception e) {
        e.printStackTrace();
    } finally {
      // 释放锁
      redisLock.unlock(); 
    }
}
</code><button class="copy-code-button">复制</button></pre></div><div data-heading="实现可重入锁" data-tag-name="h2" class="el-h2"><h2 data-heading="实现可重入锁" id="实现可重入锁" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>实现可重入锁</h2></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>65 哥：可重入锁要如何实现呢？</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>当一个线程执行一段代码成功获取锁之后，继续执行时，又遇到加锁的代码，可重入性就就保证线程能继续执行，而不可重入就是需要等待锁释放之后，再次获取锁成功，才能继续往下执行。</span></div><div data-tag-name="p" class="el-p"><span>用一段代码解释可重入：</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">public synchronized void a() {
    b();
}
public synchronized void b() {
    // pass
}
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>假设 X 线程在 a 方法获取锁之后，继续执行 b 方法，如果此时<strong>不可重入</strong>，线程就必须等待锁释放，再次争抢锁。</span></div><div data-tag-name="p" class="el-p"><span>锁明明是被 X 线程拥有，却还需要等待自己释放锁，然后再去抢锁，这看起来就很奇怪，我释放我自己~</span></div><div data-heading="Redis Hash 可重入锁" data-tag-name="h2" class="el-h2"><h2 data-heading="Redis Hash 可重入锁" id="Redis_Hash_可重入锁" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Redis Hash 可重入锁</h2></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>Redisson 类库就是通过 Redis Hash 来实现可重入锁</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>当线程拥有锁之后，往后再遇到加锁方法，直接将加锁次数加 1，然后再执行方法逻辑。</span></div><div data-tag-name="p" class="el-p"><span>退出加锁方法之后，加锁次数再减 1，当加锁次数为 0 时，锁才被真正的释放。</span></div><div data-tag-name="p" class="el-p"><span>可以看到可重入锁最大特性就是计数，计算加锁的次数。</span></div><div data-tag-name="p" class="el-p"><span>所以当可重入锁需要在分布式环境实现时，我们也就需要统计加锁次数。</span></div><div data-heading="加锁逻辑" data-tag-name="h3" class="el-h3"><h3 data-heading="加锁逻辑" id="加锁逻辑" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>加锁逻辑</h3></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>我们可以使用 Redis hash 结构实现，key 表示被锁的共享资源， hash 结构的 fieldKey 的 value 则保存加锁的次数。</span>
</blockquote></div><div data-is-embed="true" data-embed-type="image" class="el-embed-image el-p" data-tag-name="p"><span><img src="https://pic3.zhimg.com/80/v2-1f4ad0759a4ed387f6ff63ec3981d97e_720w.webp" referrerpolicy="no-referrer"></span></div><div data-tag-name="p" class="el-p"><span>通过 Lua 脚本实现原子性，假设 KEYS1 = 「lock」, ARGV「1000，uuid」：</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">---- 1 代表 true
---- 0 代表 false
if (redis.call('exists', KEYS[1]) == 0) then
    redis.call('hincrby', KEYS[1], ARGV[2], 1);
    redis.call('pexpire', KEYS[1], ARGV[1]);
    return 1;
end ;
if (redis.call('hexists', KEYS[1], ARGV[2]) == 1) then
    redis.call('hincrby', KEYS[1], ARGV[2], 1);
    redis.call('pexpire', KEYS[1], ARGV[1]);
    return 1;
end ;
return 0;
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>加锁代码首先使用 Redis&nbsp;<code>exists</code>&nbsp;命令判断当前 lock 这个锁是否存在。</span></div><div data-tag-name="p" class="el-p"><span>如果锁不存在的话，直接使用&nbsp;<code>hincrby</code>创建一个键为&nbsp;<code>lock</code>&nbsp;hash 表，并且为 Hash 表中键为&nbsp;<code>uuid</code>&nbsp;初始化为 0，然后再次加 1，最后再设置过期时间。</span></div><div data-tag-name="p" class="el-p"><span>如果当前锁存在，则使用&nbsp;<code>hexists</code>判断当前&nbsp;<code>lock</code>&nbsp;对应的 hash 表中是否存在&nbsp;<code>uuid</code>&nbsp;这个键，如果存在，再次使用&nbsp;<code>hincrby</code>&nbsp;加 1，最后再次设置过期时间。</span></div><div data-tag-name="p" class="el-p"><span>最后如果上述两个逻辑都不符合，直接返回。</span></div><div data-heading="解锁逻辑" data-tag-name="h3" class="el-h3"><h3 data-heading="解锁逻辑" id="解锁逻辑" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>解锁逻辑</h3></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">-- 判断 hash set 可重入 key 的值是否等于 0
-- 如果为 0 代表 该可重入 key 不存在
if (redis.call('hexists', KEYS[1], ARGV[1]) == 0) then
    return nil;
end ;
-- 计算当前可重入次数
local counter = redis.call('hincrby', KEYS[1], ARGV[2], -1);
-- 小于等于 0 代表可以解锁
if (counter &gt; 0) then
    return 0;
else
    redis.call('del', KEYS[1]);
    return 1;
end ;
return nil;
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>首先使用&nbsp;<code>hexists</code>&nbsp;判断 Redis Hash 表是否存给定的域。</span></div><div data-tag-name="p" class="el-p"><span>如果 lock 对应 Hash 表不存在，或者 Hash 表不存在 uuid 这个 key，直接返回&nbsp;<code>nil</code>。</span></div><div data-tag-name="p" class="el-p"><span>若存在的情况下，代表当前锁被其持有，首先使用&nbsp;<code>hincrby</code>使可重入次数减 1 ，然后判断计算之后可重入次数，若小于等于 0，则使用&nbsp;<code>del</code>&nbsp;删除这把锁。</span></div><div data-tag-name="p" class="el-p"><span>解锁代码执行方式与加锁类似，只不过解锁的执行结果返回类型使用&nbsp;<code>Long</code>。这里之所以没有跟加锁一样使用&nbsp;<code>Boolean</code>&nbsp;,这是因为解锁 lua 脚本中，三个返回值含义如下：</span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>1 代表解锁成功，锁被释放</li>
<li data-line="1"><div class="list-bullet"></div>0 代表可重入次数被减 1</li>
<li data-line="2"><div class="list-bullet"></div><code>null</code>&nbsp;代表其他线程尝试解锁，解锁失败.</li>
</ul></div><div data-heading="主从架构带来的问题" data-tag-name="h2" class="el-h2"><h2 data-heading="主从架构带来的问题" id="主从架构带来的问题" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>主从架构带来的问题</h2></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>码哥，到这里分布式锁「很完美了」吧，没想到分布式锁这么多门道。</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>路还很远，之前分析的场景都是，锁在「单个」Redis 实例中可能产生的问题，并没有涉及到 Redis 主从模式导致的问题。</span></div><div data-tag-name="p" class="el-p"><span>我们通常使用「<a data-tooltip-position="top" aria-label="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DA3cJ9iGDQMqdIb76ULk3Ug%253D%253D.55wo0mqhhCs8jHTkt2LJ7%252FxNCmB5qT14TMLnAjzdjUEqWGQli6gJ2QraYFifkn91rEpsUY28o3H37EFKZFMGPw%253D%253D" rel="noopener" class="external-link" href="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DA3cJ9iGDQMqdIb76ULk3Ug%253D%253D.55wo0mqhhCs8jHTkt2LJ7%252FxNCmB5qT14TMLnAjzdjUEqWGQli6gJ2QraYFifkn91rEpsUY28o3H37EFKZFMGPw%253D%253D" target="_blank">Cluster 集群」</a>或者「<a data-tooltip-position="top" aria-label="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DD4xxTTvzsShYhxMPt4TlJg%253D%253D.5XQcxOloezjCHBVZL%252FH5BQrTjphUB1%252F%252Bb0G6Bwx9ZsAbr45eppDcdTybc5Tl9CyoOofP6Rqbtx0Vl2XpaXSP%252BQ%253D%253D" rel="noopener" class="external-link" href="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DD4xxTTvzsShYhxMPt4TlJg%253D%253D.5XQcxOloezjCHBVZL%252FH5BQrTjphUB1%252F%252Bb0G6Bwx9ZsAbr45eppDcdTybc5Tl9CyoOofP6Rqbtx0Vl2XpaXSP%252BQ%253D%253D" target="_blank">哨兵集群</a>」的模式部署保证高可用。</span></div><div data-tag-name="p" class="el-p"><span>这两个模式都是基于「<a data-tooltip-position="top" aria-label="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DPRVK20%252BVTXwxGeIlMmTLGw%253D%253D.NiD43mUVDo9dcRb91sWTTddf0IaXVqpJ1eicNeVwoUrm5t5EDvdM76g80FH7XqMa%252FcaV3SvxjPJ1UB6%252BiexeJg%253D%253D" rel="noopener" class="external-link" href="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DPRVK20%252BVTXwxGeIlMmTLGw%253D%253D.NiD43mUVDo9dcRb91sWTTddf0IaXVqpJ1eicNeVwoUrm5t5EDvdM76g80FH7XqMa%252FcaV3SvxjPJ1UB6%252BiexeJg%253D%253D" target="_blank">主从架构数据同步复制</a>」实现的数据同步，而 Redis 的主从复制默认是异步的。</span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>以下内容来自于官方文档&nbsp;<a data-tooltip-position="top" aria-label="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DWeY%252Bd8T5Xj8nwVebX4biXA%253D%253D.CQeFeKNkPgYooOMVwY2Mypr%252BUumwhTv8eVg42I0lsFlrs2FEcxfI4%252B7qrum9G7xG" rel="noopener" class="external-link" href="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DWeY%252Bd8T5Xj8nwVebX4biXA%253D%253D.CQeFeKNkPgYooOMVwY2Mypr%252BUumwhTv8eVg42I0lsFlrs2FEcxfI4%252B7qrum9G7xG" target="_blank">https://redis.io/topics/distlock</a></span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>我们试想下如下场景会发生什么问题：</span></div><div data-tag-name="ol" class="el-ol"><ol>
<li data-line="0">客户端 A 在 master 节点获取锁成功。</li>
<li data-line="1">还没有把获取锁的信息同步到 slave 的时候，master 宕机。</li>
<li data-line="2">slave 被选举为新 master，这时候没有客户端 A 获取锁的数据。</li>
<li data-line="3">客户端 B 就能成功的获得客户端 A 持有的锁，违背了分布式锁定义的互斥。</li>
</ol></div><div data-tag-name="p" class="el-p"><span>虽然这个概率极低，但是我们必须得承认这个风险的存在。</span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>Redis 的作者提出了一种解决方案，叫 Redlock（红锁）</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>Redis 的作者为了统一分布式锁的标准，搞了一个 Redlock，算是 Redis 官方对于实现分布式锁的指导规范，<a data-tooltip-position="top" aria-label="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DeWJMPrFlPeKajAl2QZbr4Q%253D%253D.XtWXLEdvc5PivAR0CCSWCOJBlkYY9wDuipqkOaxVMtorXzRiFLyXR5SXrq%252Ff6y9k" rel="noopener" class="external-link" href="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DeWJMPrFlPeKajAl2QZbr4Q%253D%253D.XtWXLEdvc5PivAR0CCSWCOJBlkYY9wDuipqkOaxVMtorXzRiFLyXR5SXrq%252Ff6y9k" target="_blank">https://redis.io/topics/distlock</a>，但是这个 Redlock 也被国外的一些分布式专家给喷了。</span></div><div data-tag-name="p" class="el-p"><span>因为它也不完美，有“漏洞”。</span></div><div data-heading="什么是 Redlock" data-tag-name="h2" class="el-h2"><h2 data-heading="什么是 Redlock" id="什么是_Redlock" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>什么是 Redlock</h2></div><div data-tag-name="p" class="el-p"><span>红锁是不是这个？</span></div><div data-is-embed="true" data-embed-type="image" class="el-embed-image el-p" data-tag-name="p"><span><img src="https://pic1.zhimg.com/80/v2-b642a6b57122d3dcd76f64b1e0932118_720w.webp" referrerpolicy="no-referrer"></span></div><div data-tag-name="p" class="el-p"><span>泡面吃多了你，<code>Redlock</code>&nbsp;红锁是为了解决主从架构中当出现主从切换导致多个客户端持有同一个锁而提出的一种算法。</span></div><div data-tag-name="p" class="el-p"><span>大家可以看官方文档（<a data-tooltip-position="top" aria-label="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DGdPFZPAxlJn6EWaz2qiNkA%253D%253D.Uuef4jW%252BHrOwXV36Qw3%252FbtuAVI%252BKIhtiEln2ckyB3MfBArbHsrhmG1%252Fctq0iXyzn" rel="noopener" class="external-link" href="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DGdPFZPAxlJn6EWaz2qiNkA%253D%253D.Uuef4jW%252BHrOwXV36Qw3%252FbtuAVI%252BKIhtiEln2ckyB3MfBArbHsrhmG1%252Fctq0iXyzn" target="_blank">https://redis.io/topics/distlock</a>），以下来自官方文档的翻译。</span></div><div data-tag-name="p" class="el-p"><span>想用使用 Redlock，官方建议在不同机器上部署 5 个 Redis 主节点，节点都是完全独立，也不使用主从复制，使用多个节点是为容错。</span></div><div data-tag-name="p" class="el-p"><span><strong>一个客户端要获取锁有 5 个步骤</strong>：</span></div><div data-tag-name="ol" class="el-ol"><ol>
<li data-line="0">客户端获取当前时间&nbsp;<code>T1</code>（毫秒级别）；</li>
<li data-line="1">使用相同的&nbsp;<code>key</code>&nbsp;和&nbsp;<code>value</code>&nbsp;顺序尝试从&nbsp;<code>N</code>&nbsp;个&nbsp;<code>Redis</code>&nbsp;实例上获取锁。  </li>
</ol></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>每个请求都设置一个超时时间（毫秒级别），该超时时间要远小于锁的有效时间，这样便于快速尝试与下一个实例发送请求。</li>
<li data-line="1"><div class="list-bullet"></div>比如锁的自动释放时间&nbsp;<code>10s</code>，则请求的超时时间可以设置&nbsp;<code>5~50</code>&nbsp;毫秒内，这样可以防止客户端长时间阻塞。</li>
</ul></div><div data-tag-name="ol" class="el-ol"><ol>
<li data-line="0">客户端获取当前时间&nbsp;<code>T2</code>&nbsp;并减去步骤 1 的&nbsp;<code>T1</code>&nbsp;来计算出获取锁所用的时间（<code>T3 = T2 -T1</code>）。<strong>当且仅当客户端在大多数实例（<code>N/2 + 1</code>）获取成功，且获取锁所用的总时间 T3 小于锁的有效时间，才认为加锁成功，否则加锁失败。</strong></li>
<li data-line="1">如果第 3 步加锁成功，则执行业务逻辑操作共享资源，<strong>key 的真正有效时间等于有效时间减去获取锁所使用的时间（步骤 3 计算的结果）。</strong></li>
<li data-line="2">如果因为某些原因，获取锁失败（没有在至少 N/2+1 个Redis实例取到锁或者取锁时间已经超过了有效时间），<strong>客户端应该在所有的 Redis 实例上进行解锁</strong>（即便某些 Redis 实例根本就没有加锁成功）。</li>
</ol></div><div data-tag-name="p" class="el-p"><span><strong>另外部署实例的数量要求是奇数，为了能很好的满足过半原则，如果是 6 台则需要 4 台获取锁成功才能认为成功，所以奇数更合理</strong></span></div><div data-tag-name="blockquote" class="el-blockquote"><blockquote>
<span>事情可没这么简单，Redis 作者把这个方案提出后，受到了业界著名的分布式系统专家的<strong>质疑</strong>。</span>
</blockquote></div><div data-tag-name="p" class="el-p"><span>两人好比神仙打架，两人一来一回论据充足的对一个问题提出很多论断……</span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>Martin Kleppmann 提出质疑的博客：<a data-tooltip-position="top" aria-label="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DJPsoJeSIxJuHMHale3xmFw%253D%253D.HnI6VCmQHqc21pSVmCMyBLfXlqjF3QsJH%252FOlm7d0UHSTHqTgBDY5Q2WwM2DPFAsAOOK6hOTwhZoXCGqBnw2xNYP8WZpu6oC0vWzZBHBasYE%253D" rel="noopener" class="external-link" href="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DJPsoJeSIxJuHMHale3xmFw%253D%253D.HnI6VCmQHqc21pSVmCMyBLfXlqjF3QsJH%252FOlm7d0UHSTHqTgBDY5Q2WwM2DPFAsAOOK6hOTwhZoXCGqBnw2xNYP8WZpu6oC0vWzZBHBasYE%253D" target="_blank">https://martin.kleppmann.com/...</a></li>
<li data-line="1"><div class="list-bullet"></div>Redlock 设计者的回复：<a data-tooltip-position="top" aria-label="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DX3zgmkxyzOEbIWIwAW%252BrVQ%253D%253D.kNDxg4FvI9Zw5ylM82xaoTUubVCsrV1vX7ErkCbQQ%252Fg%253D" rel="noopener" class="external-link" href="https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DX3zgmkxyzOEbIWIwAW%252BrVQ%253D%253D.kNDxg4FvI9Zw5ylM82xaoTUubVCsrV1vX7ErkCbQQ%252Fg%253D" target="_blank">http://antirez.com/news/101</a></li>
</ul></div><div data-heading="Redlock 是与非" data-tag-name="h2" class="el-h2"><h2 data-heading="Redlock 是与非" id="Redlock_是与非" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Redlock 是与非</h2></div><div data-tag-name="p" class="el-p"><span>Martin Kleppmann 认为锁定的目的是为了保护对共享资源的读写，而分布式锁应该「高效」和「正确」。</span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>高效性：分布式锁应该要满足高效的性能，Redlock 算法向 5 个节点执行获取锁的逻辑性能不高，成本增加，复杂度也高；</li>
<li data-line="1"><div class="list-bullet"></div>正确性：分布式锁应该防止并发进程在同一时刻只能有一个线程能对共享数据读写。</li>
</ul></div><div data-tag-name="p" class="el-p"><span>出于这两点，我们没必要承担 Redlock 的成本和复杂，运行 5 个 Redis 实例并判断加锁是否满足大多数才算成功。</span></div><div data-tag-name="p" class="el-p"><span>主从架构崩溃恢复极小可能发生，这没什么大不了的。使用单机版就够了，Redlock 太重了，没必要。</span></div><div data-tag-name="p" class="el-p"><span><strong>Martin</strong>&nbsp;认为&nbsp;<strong>Redlock</strong>&nbsp;根本达不到安全性的要求，也依旧存在锁失效的问题！</span></div><div data-heading="Martin 的结论" data-tag-name="h3" class="el-h3"><h3 data-heading="Martin 的结论" id="Martin_的结论" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Martin 的结论</h3></div><div data-tag-name="ol" class="el-ol"><ol>
<li data-line="0"><strong>Redlock</strong>&nbsp;不伦不类：对于偏好效率来讲，<strong>Redlock</strong>&nbsp;比较重，没必要这么做，而对于偏好正确性来说，<strong>Redlock</strong>&nbsp;是不够安全的。</li>
<li data-line="1">时钟假设不合理：该算法对系统时钟做出了危险的假设（假设多个节点机器时钟都是一致的），如果不满足这些假设，锁就会失效。</li>
<li data-line="2">无法保证正确性：<strong>Redlock</strong>&nbsp;不能提供类似&nbsp;<strong>fencing token</strong>&nbsp;的方案，所以解决不了正确性的问题。为了正确性，请使用有「共识系统」的软件，例如&nbsp;<strong>Zookeeper</strong>。</li>
</ol></div><div data-heading="Redis 作者 Antirez 的反驳" data-tag-name="h2" class="el-h2"><h2 data-heading="Redis 作者 Antirez 的反驳" id="Redis_作者_Antirez_的反驳" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Redis 作者 Antirez 的反驳</h2></div><div data-tag-name="p" class="el-p"><span>在&nbsp;<strong>Redis</strong>&nbsp;作者的反驳文章中，有 3 个重点：</span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>
<span>时钟问题：<strong>Redlock</strong>&nbsp;并不需要完全一致的时钟，只需要大体一致就可以了，允许有「误差」，只要误差不要超过锁的租期即可，这种对于时钟的精度要求并不是很高，而且这也符合现实环境。</span>
</li>
<li data-line="1"><div class="list-bullet"></div>
<span>网络延迟、进程暂停问题：  </span>
</li>
<li data-line="4"><div class="list-bullet"></div>
<span>客户端在拿到锁之前，无论经历什么耗时长问题，<strong>Redlock</strong>&nbsp;都能够在第 3 步检测出来</span>
</li>
<li data-line="5"><div class="list-bullet"></div>
<span>客户端在拿到锁之后，发生&nbsp;<strong>NPC</strong>，那&nbsp;<strong>Redlock、Zookeeper</strong>&nbsp;都无能为力</span>
</li>
<li data-line="9"><div class="list-bullet"></div>
<span>质疑 fencing token 机制。</span>
</li>
</ul></div><div data-tag-name="p" class="el-p"><span>关于 Redlock 的争论我们下期再见，现在进入 Redisson 实现分布式锁实战部分。</span></div><div data-heading="Redisson 分布式锁" data-tag-name="h2" class="el-h2"><h2 data-heading="Redisson 分布式锁" id="Redisson_分布式锁" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Redisson 分布式锁</h2></div><div data-tag-name="p" class="el-p"><span>基于 SpringBoot starter 方式，添加 starter。</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">&lt;dependency&gt;
  &lt;groupId&gt;org.redisson&lt;/groupId&gt;
  &lt;artifactId&gt;redisson-spring-boot-starter&lt;/artifactId&gt;
  &lt;version&gt;3.16.4&lt;/version&gt;
&lt;/dependency&gt;
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>不过这里需要注意 springboot 与 redisson 的版本，因为官方推荐 redisson版本与 springboot 版本配合使用。</span></div><div data-tag-name="p" class="el-p"><span>将 Redisson 与 Spring Boot 库集成，还取决于 Spring Data Redis 模块。</span></div><div data-tag-name="p" class="el-p"><span>「码哥」使用 SpringBoot 2.5.x 版本， 所以需要添加 redisson-spring-data-25。</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">&lt;dependency&gt;
  &lt;groupId&gt;org.redisson&lt;/groupId&gt;
  &lt;!-- for Spring Data Redis v.2.5.x --&gt;
  &lt;artifactId&gt;redisson-spring-data-25&lt;/artifactId&gt;
  &lt;version&gt;3.16.4&lt;/version&gt;
&lt;/dependency&gt;
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>添加配置文件</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">spring:
  redis:
    database: 
    host:
    port:
    password:
    ssl: 
    timeout:
    # 根据实际情况配置 cluster 或者哨兵
    cluster:
      nodes:
    sentinel:
      master:
      nodes:
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>就这样在 Spring 容器中我们拥有以下几个 Bean可以使用:</span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div><code>RedissonClient</code></li>
<li data-line="1"><div class="list-bullet"></div><code>RedissonRxClient</code></li>
<li data-line="2"><div class="list-bullet"></div><code>RedissonReactiveClient</code></li>
<li data-line="3"><div class="list-bullet"></div><code>RedisTemplate</code></li>
<li data-line="4"><div class="list-bullet"></div><code>ReactiveRedisTemplate</code></li>
</ul></div><div data-tag-name="p" class="el-p"><span>基于Redis的Redisson分布式可重入锁<code>[RLock](https://link.zhihu.com/?target=https%3A//link.segmentfault.com/%3Fenc%3DD2s754HP6dn7V%252F7wc%252FkmVQ%253D%253D.sgYHMnmhJ%252By6UXUIkLAptnje8rBjk%252BsphrV7EJSxyAl7GAMnx%252Bcb7txx6zwp7vw5%252FixZNg4LoMl3dNES%252Fn2aShunQx6ZscC5zPIPRSE%252F2rNr730xoIw3TU5r3DsYp9JO)</code>&nbsp;Java对象实现了<code>java.util.concurrent.locks.Lock</code>接口。</span></div><div data-heading="失败无限重试" data-tag-name="h2" class="el-h2"><h2 data-heading="失败无限重试" id="失败无限重试" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>失败无限重试</h2></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">RLock lock = redisson.getLock("码哥字节");
try {

  // 1.最常用的第一种写法
  lock.lock();
  
  // 执行业务逻辑
  .....
  
} finally {
  lock.unlock();
}
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>拿锁失败时会不停的重试，具有Watch Dog 自动延期机制，默认续30s 每隔30/3=10 秒续到30s。</span></div><div data-heading="失败超时重试，自动续命" data-tag-name="h2" class="el-h2"><h2 data-heading="失败超时重试，自动续命" id="失败超时重试，自动续命" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>失败超时重试，自动续命</h2></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">// 尝试拿锁10s后停止重试,获取失败返回false，具有Watch Dog 自动延期机制， 默认续30s
boolean flag = lock.tryLock(10, TimeUnit.SECONDS); 
</code><button class="copy-code-button">复制</button></pre></div><div data-heading="超时自动释放锁" data-tag-name="h2" class="el-h2"><h2 data-heading="超时自动释放锁" id="超时自动释放锁" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>超时自动释放锁</h2></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">// 没有Watch Dog ，10s后自动释放,不需要调用 unlock 释放锁。
lock.lock(10, TimeUnit.SECONDS);
</code><button class="copy-code-button">复制</button></pre></div><div data-heading="超时重试，自动解锁" data-tag-name="h2" class="el-h2"><h2 data-heading="超时重试，自动解锁" id="超时重试，自动解锁" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>超时重试，自动解锁</h2></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">// 尝试加锁，最多等待100秒，上锁以后10秒自动解锁,没有 Watch dog
boolean res = lock.tryLock(100, 10, TimeUnit.SECONDS);
if (res) {
   try {
     ...
   } finally {
       lock.unlock();
   }
}
</code><button class="copy-code-button">复制</button></pre></div><div data-heading="Watch Dog 自动延时" data-tag-name="h2" class="el-h2"><h2 data-heading="Watch Dog 自动延时" id="Watch_Dog_自动延时" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Watch Dog 自动延时</h2></div><div data-tag-name="p" class="el-p"><span>如果获取分布式锁的节点宕机，且这个锁还出于锁定状态，就会出现死锁。</span></div><div data-tag-name="p" class="el-p"><span>为了避免这个情况，我们都会给锁设置一个超时自动释放时间。</span></div><div data-tag-name="p" class="el-p"><span>然而，还是会存在一个问题。</span></div><div data-tag-name="p" class="el-p"><span>假设线程获取锁成功，并设置了 30 s 超时，但是在 30s 内任务还没执行完，锁超时释放了，就会导致其他线程获取不该获取的锁。</span></div><div data-tag-name="p" class="el-p"><span>所以，Redisson 提供了 watch dog 自动延时机制，提供了一个监控锁的看门狗，它的作用是在Redisson实例被关闭前，不断的延长锁的有效期。</span></div><div data-tag-name="p" class="el-p"><span>也就是说，如果一个拿到锁的线程一直没有完成逻辑，那么看门狗会帮助线程不断的延长锁超时时间，锁不会因为超时而被释放。</span></div><div data-tag-name="p" class="el-p"><span>默认情况下，看门狗的续期时间是30s，也可以通过修改Config.lockWatchdogTimeout来另行指定。</span></div><div data-tag-name="p" class="el-p"><span>另外Redisson 还提供了可以指定leaseTime参数的加锁方法来指定加锁的时间。</span></div><div data-tag-name="p" class="el-p"><span>超过这个时间后锁便自动解开了，不会延长锁的有效期。</span></div><div data-tag-name="p" class="el-p"><span>原理如下图：</span></div><div data-is-embed="true" data-embed-type="image" class="el-embed-image el-p" data-tag-name="p"><span><img src="https://pic2.zhimg.com/80/v2-d5b5180898b01cb614771a87ac54bff1_720w.webp" referrerpolicy="no-referrer"></span></div><div data-tag-name="p" class="el-p"><span><strong>有两个点需要注意：</strong></span></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div><strong>watchDog 只有在未显示指定加锁超时时间（leaseTime）时才会生效。</strong></li>
<li data-line="1"><div class="list-bullet"></div><strong>lockWatchdogTimeout 设定的时间不要太小 ，比如设置的是 100毫秒，由于网络直接导致加锁完后，watchdog去延期时，这个key在redis中已经被删除了。</strong></li>
</ul></div><div data-heading="源码导读" data-tag-name="h2" class="el-h2"><h2 data-heading="源码导读" id="源码导读" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>源码导读</h2></div><div data-tag-name="p" class="el-p"><span>在调用lock方法时，会最终调用到tryAcquireAsync。调用链为：lock()-&gt;tryAcquire-&gt;tryAcquireAsync`，详细解释如下：</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">private &lt;T&gt; RFuture&lt;Long&gt; tryAcquireAsync(long waitTime, long leaseTime, TimeUnit unit, long threadId) {
        RFuture&lt;Long&gt; ttlRemainingFuture;
        //如果指定了加锁时间，会直接去加锁
        if (leaseTime != -1) {
            ttlRemainingFuture = tryLockInnerAsync(waitTime, leaseTime, unit, threadId, RedisCommands.EVAL_LONG);
        } else {
            //没有指定加锁时间 会先进行加锁，并且默认时间就是 LockWatchdogTimeout的时间
            //这个是异步操作 返回RFuture 类似netty中的future
            ttlRemainingFuture = tryLockInnerAsync(waitTime, internalLockLeaseTime,
                    TimeUnit.MILLISECONDS, threadId, RedisCommands.EVAL_LONG);
        }

        //这里也是类似netty Future 的addListener，在future内容执行完成后执行
        ttlRemainingFuture.onComplete((ttlRemaining, e) -&gt; {
            if (e != null) {
                return;
            }

            // lock acquired
            if (ttlRemaining == null) {
                // leaseTime不为-1时，不会自动延期
                if (leaseTime != -1) {
                    internalLockLeaseTime = unit.toMillis(leaseTime);
                } else {
                    //这里是定时执行 当前锁自动延期的动作,leaseTime为-1时，才会自动延期
                    scheduleExpirationRenewal(threadId);
                }
            }
        });
        return ttlRemainingFuture;
    }
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>scheduleExpirationRenewal 中会调用renewExpiration启用了一个timeout定时，去执行延期动作。</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">private void renewExpiration() {
        ExpirationEntry ee = EXPIRATION_RENEWAL_MAP.get(getEntryName());
        if (ee == null) {
            return;
        }

        Timeout task = commandExecutor.getConnectionManager()
          .newTimeout(new TimerTask() {
            @Override
            public void run(Timeout timeout) throws Exception {
                // 省略部分代码
                ....

                RFuture&lt;Boolean&gt; future = renewExpirationAsync(threadId);
                future.onComplete((res, e) -&gt; {
                    ....

                    if (res) {
                        //如果 没有报错，就再次定时延期
                        // reschedule itself
                        renewExpiration();
                    } else {
                        cancelExpirationRenewal(null);
                    }
                });
            }
            // 这里我们可以看到定时任务 是 lockWatchdogTimeout 的1/3时间去执行 renewExpirationAsync
        }, internalLockLeaseTime / 3, TimeUnit.MILLISECONDS);

        ee.setTimeout(task);
    }
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="p" class="el-p"><span>scheduleExpirationRenewal 会调用到 renewExpirationAsync，执行下面这段 lua脚本。</span></div><div data-tag-name="p" class="el-p"><span>他主要判断就是 这个锁是否在redis中存在，如果存在就进行 pexpire 延期。</span></div><div data-tag-name="pre" class="el-pre"><pre class="language-text" tabindex="0"><code class="language-text is-loaded">protected RFuture&lt;Boolean&gt; renewExpirationAsync(long threadId) {
        return evalWriteAsync(getRawName(), LongCodec.INSTANCE, RedisCommands.EVAL_BOOLEAN,
                "if (redis.call('hexists', KEYS[1], ARGV[2]) == 1) then " +
                        "redis.call('pexpire', KEYS[1], ARGV[1]); " +
                        "return 1; " +
                        "end; " +
                        "return 0;",
                Collections.singletonList(getRawName()),
                internalLockLeaseTime, getLockName(threadId));
    }
</code><button class="copy-code-button">复制</button></pre></div><div data-tag-name="ul" class="el-ul"><ul class="has-list-bullet">
<li data-line="0"><div class="list-bullet"></div>watch dog 在当前节点还存活且任务未完成则每 10 s 给锁续期 30s。</li>
<li data-line="1"><div class="list-bullet"></div>程序释放锁操作时因为异常没有被执行，那么锁无法被释放，所以释放锁操作一定要放到 finally {} 中；</li>
<li data-line="2"><div class="list-bullet"></div>要使 watchLog机制生效 ，lock时 不要设置 过期时间。</li>
<li data-line="3"><div class="list-bullet"></div>watchlog的延时时间 可以由 lockWatchdogTimeout指定默认延时时间，但是不要设置太小。</li>
<li data-line="4"><div class="list-bullet"></div>watchdog 会每 lockWatchdogTimeout/3时间，去延时。</li>
<li data-line="5"><div class="list-bullet"></div>通过 lua 脚本实现延迟。</li>
</ul></div><div data-heading="总结" data-tag-name="h2" class="el-h2"><h2 data-heading="总结" id="总结" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>总结</h2></div><div data-tag-name="p" class="el-p"><span>完工，我建议你合上屏幕，自己在脑子里重新过一遍，每一步都在做什么，为什么要做，解决什么问题。</span></div><div data-tag-name="p" class="el-p"><span>我们一起从头到尾梳理了一遍 Redis分布式锁中的各种门道，其实很多点是不管用什么做分布式锁都会存在的问题，重要的是思考的过程。</span></div><div data-heading="使用Lua脚本，保证操作原子性" data-tag-name="h3" class="el-h3"><h3 data-heading="使用Lua脚本，保证操作原子性" id="使用Lua脚本，保证操作原子性" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>使用Lua脚本，保证操作原子性</h3></div><div data-heading="Java 分布式锁实现 Redission" data-tag-name="h2" class="el-h2"><h2 data-heading="Java 分布式锁实现 Redission" id="Java_分布式锁实现_Redission" style="display: flex;"><div class="heading-collapse-indicator collapse-indicator collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div>Java 分布式锁实现 Redission</h2></div><div class="mod-footer"></div></div></div></div><div class="sidebar-right sidebar"><div class="sidebar-content"><span class="sidebar-section-header">Interactive Graph</span><div class="graph-view-placeholder">
		<div class="graph-view-container">
			<div class="graph-icon graph-expand" role="button" aria-label="Expand" data-tooltip-position="top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-arrow-up-right"><line x1="7" y1="17" x2="17" y2="7"></line><polyline points="7 7 17 7 17 17"></polyline></svg></div>
			<canvas id="graph-canvas" width="512px" height="512px"></canvas>
		</div>
		</div><div class="tree-container outline-tree" data-depth="0"><div class="tree-header"><span class="sidebar-section-header">Table Of Contents</span><button class="clickable-icon collapse-tree-button is-collapsed"><iconify-icon icon="ph:arrows-in-line-horizontal-bold" width="18px" height="18px" rotate="90deg" color="currentColor"></iconify-icon></button></div><div class="tree-scroll-area"><div class="tree-item mod-tree-heading" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="#Redis分布式锁应用（实现+原理）"><span class="tree-item-title">Redis分布式锁应用（实现+原理）</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#Redis分布式锁介绍"><span class="tree-item-title">Redis分布式锁介绍</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="#Redis分布式锁命令"><span class="tree-item-title">Redis分布式锁命令</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-heading" data-depth="4"><div class="tree-item-contents"><a class="tree-item-link" href="#1)_常用命令"><span class="tree-item-title">1) 常用命令</span></a></div><div class="tree-item-children"></div></div></div></div></div></div><div class="tree-item mod-tree-heading" data-depth="1"><div class="tree-item-contents"><a class="tree-item-link" href="#Redis_分布式锁的正确实现原理演化历程与_Redission_实战总结"><span class="tree-item-title">Redis 分布式锁的正确实现原理演化历程与 Redission 实战总结</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#什么时候用分布式锁？"><span class="tree-item-title">什么时候用分布式锁？</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#分布式锁入门"><span class="tree-item-title">分布式锁入门</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#超时设置"><span class="tree-item-title">超时设置</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#释放了不是自己加的锁"><span class="tree-item-title">释放了不是自己加的锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#正确设置锁超时"><span class="tree-item-title">正确设置锁超时</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#加解锁代码位置有讲究"><span class="tree-item-title">加解锁代码位置有讲究</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#实现可重入锁"><span class="tree-item-title">实现可重入锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="#Redis_Hash_可重入锁"><span class="tree-item-title">Redis Hash 可重入锁</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-heading" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="#加锁逻辑"><span class="tree-item-title">加锁逻辑</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="#解锁逻辑"><span class="tree-item-title">解锁逻辑</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#主从架构带来的问题"><span class="tree-item-title">主从架构带来的问题</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#什么是_Redlock"><span class="tree-item-title">什么是 Redlock</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="#Redlock_是与非"><span class="tree-item-title">Redlock 是与非</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-heading" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="#Martin_的结论"><span class="tree-item-title">Martin 的结论</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#Redis_作者_Antirez_的反驳"><span class="tree-item-title">Redis 作者 Antirez 的反驳</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#Redisson_分布式锁"><span class="tree-item-title">Redisson 分布式锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#失败无限重试"><span class="tree-item-title">失败无限重试</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#失败超时重试，自动续命"><span class="tree-item-title">失败超时重试，自动续命</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#超时自动释放锁"><span class="tree-item-title">超时自动释放锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#超时重试，自动解锁"><span class="tree-item-title">超时重试，自动解锁</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#Watch_Dog_自动延时"><span class="tree-item-title">Watch Dog 自动延时</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#源码导读"><span class="tree-item-title">源码导读</span></a></div><div class="tree-item-children"></div></div><div class="tree-item mod-tree-heading mod-collapsible is-collapsed" data-depth="2"><div class="tree-item-contents"><div class="tree-item-icon collapse-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon right-triangle"><path d="M3 8L12 17L21 8"></path></svg></div><a class="tree-item-link" href="#总结"><span class="tree-item-title">总结</span></a></div><div class="tree-item-children"><div class="tree-item mod-tree-heading" data-depth="3"><div class="tree-item-contents"><a class="tree-item-link" href="#使用Lua脚本，保证操作原子性"><span class="tree-item-title">使用Lua脚本，保证操作原子性</span></a></div><div class="tree-item-children"></div></div></div></div><div class="tree-item mod-tree-heading" data-depth="2"><div class="tree-item-contents"><a class="tree-item-link" href="#Java_分布式锁实现_Redission"><span class="tree-item-title">Java 分布式锁实现 Redission</span></a></div><div class="tree-item-children"></div></div></div></div></div></div></div></div></div></body></html>